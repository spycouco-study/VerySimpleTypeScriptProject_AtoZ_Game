import * as THREE from "three";
import * as CANNON from "cannon-es";
var GameState = /* @__PURE__ */ ((GameState2) => {
  GameState2[GameState2["TITLE"] = 0] = "TITLE";
  GameState2[GameState2["PLAYING"] = 1] = "PLAYING";
  return GameState2;
})(GameState || {});
let gameState = 0 /* TITLE */;
let gameConfig;
let scene;
let camera;
let renderer;
let canvas;
let world;
let playerBody;
let playerMesh;
let cannonGroundMaterial;
let cannonPlayerMaterial;
let keys = { w: false, a: false, s: false, d: false };
let mouseSensitivity;
let mousePitch = 0;
let mouseYaw = 0;
let minPitch;
let maxPitch;
let animationFrameId;
let lastTime;
let titleScreenDiv = null;
let audioListener;
let audioLoader;
let bgMusic;
async function fetchConfigAndInit() {
  try {
    const response = await fetch("data.json");
    gameConfig = await response.json();
    initializeGame();
  } catch (error) {
    console.error("Failed to load game config:", error);
  }
}
function initializeGame() {
  canvas = document.getElementById("gameCanvas");
  if (!canvas) {
    console.error("Canvas with ID 'gameCanvas' not found.");
    return;
  }
  renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setPixelRatio(window.devicePixelRatio);
  renderer.shadowMap.enabled = true;
  renderer.shadowMap.type = THREE.PCFSoftShadowMap;
  scene = new THREE.Scene();
  scene.background = new THREE.Color(8900331);
  camera = new THREE.PerspectiveCamera(
    gameConfig.camera.fov,
    window.innerWidth / window.innerHeight,
    gameConfig.camera.near,
    gameConfig.camera.far
  );
  world = new CANNON.World();
  world.gravity.set(0, gameConfig.world.gravityY, 0);
  world.broadphase = new CANNON.SAPBroadphase(world);
  world.solver.iterations = 10;
  const textureLoader = new THREE.TextureLoader();
  audioListener = new THREE.AudioListener();
  camera.add(audioListener);
  audioLoader = new THREE.AudioLoader();
  const groundTexture = textureLoader.load(
    gameConfig.world.ground.assetPath,
    (texture) => {
      texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
      texture.repeat.set(gameConfig.world.ground.size / 4, gameConfig.world.ground.size / 4);
    },
    void 0,
    (err) => console.warn("Error loading ground texture:", err, "Using default material.")
  );
  const groundMaterial = new THREE.MeshPhongMaterial({ map: groundTexture, side: THREE.DoubleSide });
  const groundMesh = new THREE.Mesh(
    new THREE.PlaneGeometry(gameConfig.world.ground.size, gameConfig.world.ground.size),
    new THREE.MeshPhongMaterial({ color: 8421504, map: groundTexture })
    // Fallback color
  );
  groundMesh.rotation.x = -Math.PI / 2;
  groundMesh.receiveShadow = true;
  scene.add(groundMesh);
  cannonGroundMaterial = new CANNON.Material("groundMaterial");
  const groundBody = new CANNON.Body({
    mass: 0,
    // Static body
    shape: new CANNON.Plane(),
    material: cannonGroundMaterial
    // Use the stored material
  });
  groundBody.quaternion.setFromEuler(-Math.PI / 2, 0, 0);
  world.addBody(groundBody);
  const playerRadius = gameConfig.player.radius;
  const playerTotalHeight = gameConfig.player.height;
  const playerCylinderLength = playerTotalHeight - 2 * playerRadius;
  const playerGeo = new THREE.CapsuleGeometry(playerRadius, playerCylinderLength, 16, 32);
  const playerTexture = textureLoader.load(
    gameConfig.player.assetPath,
    (texture) => {
      playerMesh.material.map = texture;
      playerMesh.material.needsUpdate = true;
    },
    void 0,
    (err) => console.warn("Error loading player texture:", err, "Using default color.")
  );
  const playerMaterial = new THREE.MeshPhongMaterial({ color: 65280, map: playerTexture });
  playerMesh = new THREE.Mesh(playerGeo, playerMaterial);
  playerMesh.position.y = playerTotalHeight / 2 + 1;
  playerMesh.castShadow = true;
  scene.add(playerMesh);
  cannonPlayerMaterial = new CANNON.Material("playerMaterial");
  playerBody = new CANNON.Body({
    mass: gameConfig.player.mass,
    shape: new CANNON.Cylinder(playerRadius, playerRadius, playerTotalHeight, 16),
    // Cannon.js cylinder height is total height
    position: new CANNON.Vec3(0, playerTotalHeight / 2 + 1, 0),
    material: cannonPlayerMaterial
    // Use the stored material
  });
  playerBody.fixedRotation = true;
  playerBody.angularFactor.set(0, 0, 0);
  world.addBody(playerBody);
  const playerGroundCm = new CANNON.ContactMaterial(
    cannonPlayerMaterial,
    cannonGroundMaterial,
    {
      friction: 0.5,
      restitution: 0.1
    }
  );
  world.addContactMaterial(playerGroundCm);
  const ambientLight = new THREE.AmbientLight(gameConfig.lighting.ambientColor);
  scene.add(ambientLight);
  const directionalLight = new THREE.DirectionalLight(gameConfig.lighting.directionalColor, gameConfig.lighting.directionalIntensity);
  directionalLight.position.set(gameConfig.lighting.directionalPosition[0], gameConfig.lighting.directionalPosition[1], gameConfig.lighting.directionalPosition[2]);
  directionalLight.castShadow = true;
  directionalLight.shadow.mapSize.width = 1024;
  directionalLight.shadow.mapSize.height = 1024;
  directionalLight.shadow.camera.near = 0.5;
  directionalLight.shadow.camera.far = 50;
  directionalLight.shadow.camera.left = -20;
  directionalLight.shadow.camera.right = 20;
  directionalLight.shadow.camera.top = 20;
  directionalLight.shadow.camera.bottom = -20;
  scene.add(directionalLight);
  window.addEventListener("resize", onWindowResize);
  document.addEventListener("keydown", onKeyDown);
  document.addEventListener("keyup", onKeyUp);
  document.addEventListener("mousemove", onMouseMove);
  document.addEventListener("click", onClick);
  mouseSensitivity = gameConfig.camera.sensitivity;
  minPitch = gameConfig.camera.minPitch * Math.PI / 180;
  maxPitch = gameConfig.camera.maxPitch * Math.PI / 180;
  showTitleScreen();
}
function showTitleScreen() {
  gameState = 0 /* TITLE */;
  if (!titleScreenDiv) {
    titleScreenDiv = document.createElement("div");
    titleScreenDiv.id = "titleScreen";
    titleScreenDiv.style.cssText = `
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: ${gameConfig.titleScreen.backgroundColor};
            color: ${gameConfig.titleScreen.fontColor};
            font-family: 'Arial', sans-serif;
            font-size: ${gameConfig.titleScreen.fontSize};
            z-index: 100;
        `;
    const titleText = document.createElement("h1");
    titleText.textContent = gameConfig.gameTitle;
    titleText.style.marginBottom = "20px";
    titleScreenDiv.appendChild(titleText);
    const clickToStartText = document.createElement("p");
    clickToStartText.textContent = gameConfig.titleScreen.message;
    titleScreenDiv.appendChild(clickToStartText);
    document.body.appendChild(titleScreenDiv);
  } else {
    titleScreenDiv.style.display = "flex";
  }
}
function hideTitleScreen() {
  if (titleScreenDiv) {
    titleScreenDiv.style.display = "none";
  }
  gameState = 1 /* PLAYING */;
  canvas.requestPointerLock = canvas.requestPointerLock || canvas.mozRequestPointerLock;
  canvas.requestPointerLock();
  startAudio();
  lastTime = performance.now();
  animate();
}
function startAudio() {
  if (bgMusic && bgMusic.isPlaying) {
    return;
  }
  audioLoader.load(gameConfig.audio.backgroundMusic, function(buffer) {
    bgMusic = new THREE.Audio(audioListener);
    bgMusic.setBuffer(buffer);
    bgMusic.setLoop(true);
    bgMusic.setVolume(gameConfig.audio.volume);
    bgMusic.play();
  }, void 0, (err) => console.warn("Error loading background music:", err, "Audio will not play."));
}
function onWindowResize() {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
}
function onKeyDown(event) {
  if (gameState !== 1 /* PLAYING */) return;
  switch (event.code) {
    case "KeyW":
      keys.w = true;
      break;
    case "KeyA":
      keys.a = true;
      break;
    case "KeyS":
      keys.s = true;
      break;
    case "KeyD":
      keys.d = true;
      break;
  }
}
function onKeyUp(event) {
  if (gameState !== 1 /* PLAYING */) return;
  switch (event.code) {
    case "KeyW":
      keys.w = false;
      break;
    case "KeyA":
      keys.a = false;
      break;
    case "KeyS":
      keys.s = false;
      break;
    case "KeyD":
      keys.d = false;
      break;
  }
}
function onMouseMove(event) {
  if (gameState !== 1 /* PLAYING */ || document.pointerLockElement !== canvas) return;
  mouseYaw -= event.movementX * mouseSensitivity;
  mousePitch -= event.movementY * mouseSensitivity;
  mousePitch = Math.max(minPitch, Math.min(maxPitch, mousePitch));
}
function onClick() {
  if (gameState === 0 /* TITLE */) {
    hideTitleScreen();
  }
}
function animate() {
  animationFrameId = requestAnimationFrame(animate);
  const currentTime = performance.now();
  const deltaTime = (currentTime - lastTime) / 1e3;
  lastTime = currentTime;
  if (gameState === 1 /* PLAYING */) {
    world.step(1 / 60, deltaTime, 3);
    const playerSpeed = gameConfig.player.speed;
    const playerMass = gameConfig.player.mass;
    const inputVector = new THREE.Vector3(0, 0, 0);
    if (keys.w) inputVector.z -= 1;
    if (keys.s) inputVector.z += 1;
    if (keys.a) inputVector.x -= 1;
    if (keys.d) inputVector.x += 1;
    if (inputVector.lengthSq() > 0) {
      inputVector.normalize();
    }
    const forwardVector = new THREE.Vector3(0, 0, -1);
    forwardVector.applyAxisAngle(new THREE.Vector3(0, 1, 0), mouseYaw);
    const rightVector = new THREE.Vector3(1, 0, 0);
    rightVector.applyAxisAngle(new THREE.Vector3(0, 1, 0), mouseYaw);
    const moveDirection = new THREE.Vector3();
    moveDirection.addScaledVector(forwardVector, inputVector.z);
    moveDirection.addScaledVector(rightVector, inputVector.x);
    const currentVelocity = playerBody.velocity;
    const desiredVelocity = new CANNON.Vec3(moveDirection.x * playerSpeed, currentVelocity.y, moveDirection.z * playerSpeed);
    const impulse = desiredVelocity.vsub(currentVelocity).scale(playerMass);
    playerBody.applyImpulse(impulse);
    const maxHorizontalSpeed = playerSpeed * 1.5;
    const currentHorizontalSpeedSq = currentVelocity.x * currentVelocity.x + currentVelocity.z * currentVelocity.z;
    if (currentHorizontalSpeedSq > maxHorizontalSpeed * maxHorizontalSpeed) {
      const scale = maxHorizontalSpeed / Math.sqrt(currentHorizontalSpeedSq);
      playerBody.velocity.x *= scale;
      playerBody.velocity.z *= scale;
    }
    playerMesh.position.copy(playerBody.position);
    playerMesh.quaternion.setFromAxisAngle(new THREE.Vector3(0, 1, 0), mouseYaw);
    const playerWorldPosition = new THREE.Vector3(playerBody.position.x, playerBody.position.y, playerBody.position.z);
    const cameraRelativeOffset = new THREE.Vector3(
      gameConfig.camera.offsetX,
      gameConfig.camera.offsetY,
      gameConfig.camera.offsetZ
    );
    cameraRelativeOffset.applyAxisAngle(new THREE.Vector3(0, 1, 0), mouseYaw);
    camera.position.copy(playerWorldPosition).add(cameraRelativeOffset);
    const tempQuaternion = new THREE.Quaternion();
    const tempVector = new THREE.Vector3();
    tempQuaternion.setFromAxisAngle(tempVector.set(0, 1, 0), mouseYaw);
    camera.quaternion.copy(tempQuaternion);
    tempQuaternion.setFromAxisAngle(tempVector.set(1, 0, 0), mousePitch);
    camera.quaternion.multiplyQuaternions(camera.quaternion, tempQuaternion);
  }
  renderer.render(scene, camera);
}
fetchConfigAndInit();
document.addEventListener("pointerlockchange", () => {
  if (document.pointerLockElement === canvas) {
  } else {
  }
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiZ2FtZS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xyXG5pbXBvcnQgKiBhcyBDQU5OT04gZnJvbSAnY2Fubm9uLWVzJztcclxuXHJcbi8vIC0tLSBHbG9iYWwgVmFyaWFibGVzICYgRW51bXMgLS0tXHJcbmVudW0gR2FtZVN0YXRlIHtcclxuICAgIFRJVExFLFxyXG4gICAgUExBWUlOR1xyXG59XHJcblxyXG5sZXQgZ2FtZVN0YXRlOiBHYW1lU3RhdGUgPSBHYW1lU3RhdGUuVElUTEU7XHJcbmxldCBnYW1lQ29uZmlnOiBhbnk7XHJcblxyXG4vLyBUaHJlZS5qcyBlbGVtZW50c1xyXG5sZXQgc2NlbmU6IFRIUkVFLlNjZW5lO1xyXG5sZXQgY2FtZXJhOiBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYTtcclxubGV0IHJlbmRlcmVyOiBUSFJFRS5XZWJHTFJlbmRlcmVyO1xyXG5sZXQgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudDtcclxuXHJcbi8vIENhbm5vbi5qcyBlbGVtZW50c1xyXG5sZXQgd29ybGQ6IENBTk5PTi5Xb3JsZDtcclxubGV0IHBsYXllckJvZHk6IENBTk5PTi5Cb2R5O1xyXG5sZXQgcGxheWVyTWVzaDogVEhSRUUuTWVzaDtcclxubGV0IGNhbm5vbkdyb3VuZE1hdGVyaWFsOiBDQU5OT04uTWF0ZXJpYWw7IC8vIERlY2xhcmVkIGdsb2JhbGx5IG9yIHdpdGhpbiBpbml0aWFsaXplR2FtZSBzY29wZVxyXG5sZXQgY2Fubm9uUGxheWVyTWF0ZXJpYWw6IENBTk5PTi5NYXRlcmlhbDsgLy8gRGVjbGFyZWQgZ2xvYmFsbHkgb3Igd2l0aGluIGluaXRpYWxpemVHYW1lIHNjb3BlXHJcblxyXG4vLyBJbnB1dCBzdGF0ZVxyXG5pbnRlcmZhY2UgS2V5U3RhdGUge1xyXG4gICAgdzogYm9vbGVhbjtcclxuICAgIGE6IGJvb2xlYW47XHJcbiAgICBzOiBib29sZWFuO1xyXG4gICAgZDogYm9vbGVhbjtcclxufVxyXG5sZXQga2V5czogS2V5U3RhdGUgPSB7IHc6IGZhbHNlLCBhOiBmYWxzZSwgczogZmFsc2UsIGQ6IGZhbHNlIH07XHJcbmxldCBtb3VzZVNlbnNpdGl2aXR5OiBudW1iZXI7XHJcbmxldCBtb3VzZVBpdGNoID0gMDsgLy8gVXAvZG93biByb3RhdGlvblxyXG5sZXQgbW91c2VZYXcgPSAwOyAgIC8vIExlZnQvcmlnaHQgcm90YXRpb25cclxubGV0IG1pblBpdGNoOiBudW1iZXI7XHJcbmxldCBtYXhQaXRjaDogbnVtYmVyO1xyXG5cclxuLy8gR2FtZSBMb29wIG1hbmFnZW1lbnRcclxubGV0IGFuaW1hdGlvbkZyYW1lSWQ6IG51bWJlcjtcclxubGV0IGxhc3RUaW1lOiBudW1iZXI7IC8vIEZvciBkZWx0YSB0aW1lIGNhbGN1bGF0aW9uXHJcblxyXG4vLyBVSSBFbGVtZW50cyAoVGl0bGUgU2NyZWVuKVxyXG5sZXQgdGl0bGVTY3JlZW5EaXY6IEhUTUxEaXZFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblxyXG4vLyBBdWRpb1xyXG5sZXQgYXVkaW9MaXN0ZW5lcjogVEhSRUUuQXVkaW9MaXN0ZW5lcjtcclxubGV0IGF1ZGlvTG9hZGVyOiBUSFJFRS5BdWRpb0xvYWRlcjtcclxubGV0IGJnTXVzaWM6IFRIUkVFLkF1ZGlvO1xyXG5cclxuLy8gLS0tIEluaXRpYWxpemF0aW9uIEZ1bmN0aW9ucyAtLS1cclxuXHJcbi8qKlxyXG4gKiBGZXRjaGVzIGdhbWUgY29uZmlndXJhdGlvbiBmcm9tIGRhdGEuanNvbiBhbmQgaW5pdGlhbGl6ZXMgdGhlIGdhbWUuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBmZXRjaENvbmZpZ0FuZEluaXQoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2RhdGEuanNvbicpO1xyXG4gICAgICAgIGdhbWVDb25maWcgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgaW5pdGlhbGl6ZUdhbWUoKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBsb2FkIGdhbWUgY29uZmlnOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXRzIHVwIFRocmVlLmpzIHNjZW5lLCBjYW1lcmEsIHJlbmRlcmVyLCBDYW5ub24uanMgd29ybGQsIGFuZCBnYW1lIG9iamVjdHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBpbml0aWFsaXplR2FtZSgpIHtcclxuICAgIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnYW1lQ2FudmFzJykgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbiAgICBpZiAoIWNhbnZhcykge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDYW52YXMgd2l0aCBJRCAnZ2FtZUNhbnZhcycgbm90IGZvdW5kLlwiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMS4gUmVuZGVyZXIgU2V0dXBcclxuICAgIHJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoeyBjYW52YXMsIGFudGlhbGlhczogdHJ1ZSB9KTtcclxuICAgIHJlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7XHJcbiAgICByZW5kZXJlci5zZXRQaXhlbFJhdGlvKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKTtcclxuICAgIHJlbmRlcmVyLnNoYWRvd01hcC5lbmFibGVkID0gdHJ1ZTtcclxuICAgIHJlbmRlcmVyLnNoYWRvd01hcC50eXBlID0gVEhSRUUuUENGU29mdFNoYWRvd01hcDsgLy8gU29mdGVyIHNoYWRvd3NcclxuXHJcbiAgICAvLyAyLiBTY2VuZSBTZXR1cFxyXG4gICAgc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKTtcclxuICAgIHNjZW5lLmJhY2tncm91bmQgPSBuZXcgVEhSRUUuQ29sb3IoMHg4N2NlZWIpOyAvLyBTa3kgYmx1ZSBiYWNrZ3JvdW5kXHJcblxyXG4gICAgLy8gMy4gQ2FtZXJhIFNldHVwXHJcbiAgICBjYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoXHJcbiAgICAgICAgZ2FtZUNvbmZpZy5jYW1lcmEuZm92LFxyXG4gICAgICAgIHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0LFxyXG4gICAgICAgIGdhbWVDb25maWcuY2FtZXJhLm5lYXIsXHJcbiAgICAgICAgZ2FtZUNvbmZpZy5jYW1lcmEuZmFyXHJcbiAgICApO1xyXG4gICAgLy8gQ2FtZXJhJ3MgaW5pdGlhbCBwb3NpdGlvbiB3aWxsIGJlIHNldCByZWxhdGl2ZSB0byB0aGUgcGxheWVyIGxhdGVyLlxyXG5cclxuICAgIC8vIDQuIENhbm5vbi5qcyBXb3JsZCBTZXR1cFxyXG4gICAgd29ybGQgPSBuZXcgQ0FOTk9OLldvcmxkKCk7XHJcbiAgICB3b3JsZC5ncmF2aXR5LnNldCgwLCBnYW1lQ29uZmlnLndvcmxkLmdyYXZpdHlZLCAwKTtcclxuICAgIHdvcmxkLmJyb2FkcGhhc2UgPSBuZXcgQ0FOTk9OLlNBUEJyb2FkcGhhc2Uod29ybGQpOyAvLyBPcHRpbWl6ZSBjb2xsaXNpb24gZGV0ZWN0aW9uXHJcbiAgICAod29ybGQuc29sdmVyIGFzIENBTk5PTi5HU1NvbHZlcikuaXRlcmF0aW9ucyA9IDEwOyAvLyBGaXg6IENhc3Qgc29sdmVyIHRvIEdTU29sdmVyIHRvIGFjY2VzcyBpdGVyYXRpb25zXHJcblxyXG4gICAgLy8gNS4gTG9hZGVycyBhbmQgQXVkaW8gTGlzdGVuZXJcclxuICAgIGNvbnN0IHRleHR1cmVMb2FkZXIgPSBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpO1xyXG4gICAgYXVkaW9MaXN0ZW5lciA9IG5ldyBUSFJFRS5BdWRpb0xpc3RlbmVyKCk7XHJcbiAgICBjYW1lcmEuYWRkKGF1ZGlvTGlzdGVuZXIpOyAvLyBBZGQgbGlzdGVuZXIgdG8gY2FtZXJhXHJcbiAgICBhdWRpb0xvYWRlciA9IG5ldyBUSFJFRS5BdWRpb0xvYWRlcigpO1xyXG5cclxuICAgIC8vIDYuIEdyb3VuZCBDcmVhdGlvbiAoVmlzdWFsIGFuZCBQaHlzaWNhbClcclxuICAgIGNvbnN0IGdyb3VuZFRleHR1cmUgPSB0ZXh0dXJlTG9hZGVyLmxvYWQoZ2FtZUNvbmZpZy53b3JsZC5ncm91bmQuYXNzZXRQYXRoLFxyXG4gICAgICAgICh0ZXh0dXJlKSA9PiB7XHJcbiAgICAgICAgICAgIHRleHR1cmUud3JhcFMgPSB0ZXh0dXJlLndyYXBUID0gVEhSRUUuUmVwZWF0V3JhcHBpbmc7XHJcbiAgICAgICAgICAgIHRleHR1cmUucmVwZWF0LnNldChnYW1lQ29uZmlnLndvcmxkLmdyb3VuZC5zaXplIC8gNCwgZ2FtZUNvbmZpZy53b3JsZC5ncm91bmQuc2l6ZSAvIDQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdW5kZWZpbmVkLFxyXG4gICAgICAgIChlcnIpID0+IGNvbnNvbGUud2FybignRXJyb3IgbG9hZGluZyBncm91bmQgdGV4dHVyZTonLCBlcnIsICdVc2luZyBkZWZhdWx0IG1hdGVyaWFsLicpXHJcbiAgICApO1xyXG4gICAgY29uc3QgZ3JvdW5kTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoeyBtYXA6IGdyb3VuZFRleHR1cmUsIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUgfSk7XHJcbiAgICBjb25zdCBncm91bmRNZXNoID0gbmV3IFRIUkVFLk1lc2goXHJcbiAgICAgICAgbmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoZ2FtZUNvbmZpZy53b3JsZC5ncm91bmQuc2l6ZSwgZ2FtZUNvbmZpZy53b3JsZC5ncm91bmQuc2l6ZSksXHJcbiAgICAgICAgbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHsgY29sb3I6IDB4ODA4MDgwLCBtYXA6IGdyb3VuZFRleHR1cmUgfSkgLy8gRmFsbGJhY2sgY29sb3JcclxuICAgICk7XHJcbiAgICBncm91bmRNZXNoLnJvdGF0aW9uLnggPSAtTWF0aC5QSSAvIDI7XHJcbiAgICBncm91bmRNZXNoLnJlY2VpdmVTaGFkb3cgPSB0cnVlO1xyXG4gICAgc2NlbmUuYWRkKGdyb3VuZE1lc2gpO1xyXG5cclxuICAgIC8vIEZpeDogU3RvcmUgQ0FOTk9OLk1hdGVyaWFsIGluc3RhbmNlcyBpbiB2YXJpYWJsZXNcclxuICAgIGNhbm5vbkdyb3VuZE1hdGVyaWFsID0gbmV3IENBTk5PTi5NYXRlcmlhbCgnZ3JvdW5kTWF0ZXJpYWwnKTtcclxuICAgIGNvbnN0IGdyb3VuZEJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoe1xyXG4gICAgICAgIG1hc3M6IDAsIC8vIFN0YXRpYyBib2R5XHJcbiAgICAgICAgc2hhcGU6IG5ldyBDQU5OT04uUGxhbmUoKSxcclxuICAgICAgICBtYXRlcmlhbDogY2Fubm9uR3JvdW5kTWF0ZXJpYWwgLy8gVXNlIHRoZSBzdG9yZWQgbWF0ZXJpYWxcclxuICAgIH0pO1xyXG4gICAgZ3JvdW5kQm9keS5xdWF0ZXJuaW9uLnNldEZyb21FdWxlcigtTWF0aC5QSSAvIDIsIDAsIDApOyAvLyBSb3RhdGUgdG8gbGllIGZsYXRcclxuICAgIHdvcmxkLmFkZEJvZHkoZ3JvdW5kQm9keSk7XHJcblxyXG4gICAgLy8gNy4gUGxheWVyIENyZWF0aW9uIChWaXN1YWwgYW5kIFBoeXNpY2FsKVxyXG4gICAgY29uc3QgcGxheWVyUmFkaXVzID0gZ2FtZUNvbmZpZy5wbGF5ZXIucmFkaXVzO1xyXG4gICAgY29uc3QgcGxheWVyVG90YWxIZWlnaHQgPSBnYW1lQ29uZmlnLnBsYXllci5oZWlnaHQ7XHJcbiAgICBjb25zdCBwbGF5ZXJDeWxpbmRlckxlbmd0aCA9IHBsYXllclRvdGFsSGVpZ2h0IC0gMiAqIHBsYXllclJhZGl1czsgLy8gTGVuZ3RoIG9mIHRoZSBzdHJhaWdodCBwYXJ0XHJcblxyXG4gICAgY29uc3QgcGxheWVyR2VvID0gbmV3IFRIUkVFLkNhcHN1bGVHZW9tZXRyeShwbGF5ZXJSYWRpdXMsIHBsYXllckN5bGluZGVyTGVuZ3RoLCAxNiwgMzIpO1xyXG4gICAgY29uc3QgcGxheWVyVGV4dHVyZSA9IHRleHR1cmVMb2FkZXIubG9hZChnYW1lQ29uZmlnLnBsYXllci5hc3NldFBhdGgsXHJcbiAgICAgICAgKHRleHR1cmUpID0+IHtcclxuICAgICAgICAgICAgKHBsYXllck1lc2gubWF0ZXJpYWwgYXMgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwpLm1hcCA9IHRleHR1cmU7XHJcbiAgICAgICAgICAgIChwbGF5ZXJNZXNoLm1hdGVyaWFsIGFzIFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKS5uZWVkc1VwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB1bmRlZmluZWQsXHJcbiAgICAgICAgKGVycikgPT4gY29uc29sZS53YXJuKCdFcnJvciBsb2FkaW5nIHBsYXllciB0ZXh0dXJlOicsIGVyciwgJ1VzaW5nIGRlZmF1bHQgY29sb3IuJylcclxuICAgICk7XHJcbiAgICBjb25zdCBwbGF5ZXJNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCh7IGNvbG9yOiAweDAwZmYwMCwgbWFwOiBwbGF5ZXJUZXh0dXJlIH0pOyAvLyBEZWZhdWx0IGNvbG9yICsgdGV4dHVyZVxyXG4gICAgcGxheWVyTWVzaCA9IG5ldyBUSFJFRS5NZXNoKHBsYXllckdlbywgcGxheWVyTWF0ZXJpYWwpO1xyXG4gICAgcGxheWVyTWVzaC5wb3NpdGlvbi55ID0gcGxheWVyVG90YWxIZWlnaHQgLyAyICsgMTsgLy8gU3RhcnQgc2xpZ2h0bHkgYWJvdmUgZ3JvdW5kXHJcbiAgICBwbGF5ZXJNZXNoLmNhc3RTaGFkb3cgPSB0cnVlO1xyXG4gICAgc2NlbmUuYWRkKHBsYXllck1lc2gpO1xyXG5cclxuICAgIC8vIEZpeDogU3RvcmUgQ0FOTk9OLk1hdGVyaWFsIGluc3RhbmNlcyBpbiB2YXJpYWJsZXNcclxuICAgIGNhbm5vblBsYXllck1hdGVyaWFsID0gbmV3IENBTk5PTi5NYXRlcmlhbCgncGxheWVyTWF0ZXJpYWwnKTtcclxuICAgIHBsYXllckJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoe1xyXG4gICAgICAgIG1hc3M6IGdhbWVDb25maWcucGxheWVyLm1hc3MsXHJcbiAgICAgICAgc2hhcGU6IG5ldyBDQU5OT04uQ3lsaW5kZXIocGxheWVyUmFkaXVzLCBwbGF5ZXJSYWRpdXMsIHBsYXllclRvdGFsSGVpZ2h0LCAxNiksIC8vIENhbm5vbi5qcyBjeWxpbmRlciBoZWlnaHQgaXMgdG90YWwgaGVpZ2h0XHJcbiAgICAgICAgcG9zaXRpb246IG5ldyBDQU5OT04uVmVjMygwLCBwbGF5ZXJUb3RhbEhlaWdodCAvIDIgKyAxLCAwKSxcclxuICAgICAgICBtYXRlcmlhbDogY2Fubm9uUGxheWVyTWF0ZXJpYWwgLy8gVXNlIHRoZSBzdG9yZWQgbWF0ZXJpYWxcclxuICAgIH0pO1xyXG4gICAgcGxheWVyQm9keS5maXhlZFJvdGF0aW9uID0gdHJ1ZTsgLy8gUHJldmVudCBwbGF5ZXIgZnJvbSB0b3BwbGluZ1xyXG4gICAgcGxheWVyQm9keS5hbmd1bGFyRmFjdG9yLnNldCgwLCAwLCAwKTsgLy8gRGlzYWJsZSBhbmd1bGFyIHJvdGF0aW9uIGVudGlyZWx5XHJcbiAgICB3b3JsZC5hZGRCb2R5KHBsYXllckJvZHkpO1xyXG5cclxuICAgIC8vIDguIENvbnRhY3QgTWF0ZXJpYWxzIChmb3IgcGh5c2ljcyBmcmljdGlvbi9yZXN0aXR1dGlvbilcclxuICAgIC8vIEZpeDogVXNlIHRoZSBzdG9yZWQgQ0FOTk9OLk1hdGVyaWFsIGluc3RhbmNlcyBkaXJlY3RseVxyXG4gICAgY29uc3QgcGxheWVyR3JvdW5kQ20gPSBuZXcgQ0FOTk9OLkNvbnRhY3RNYXRlcmlhbChcclxuICAgICAgICBjYW5ub25QbGF5ZXJNYXRlcmlhbCxcclxuICAgICAgICBjYW5ub25Hcm91bmRNYXRlcmlhbCxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZyaWN0aW9uOiAwLjUsXHJcbiAgICAgICAgICAgIHJlc3RpdHV0aW9uOiAwLjFcclxuICAgICAgICB9XHJcbiAgICApO1xyXG4gICAgd29ybGQuYWRkQ29udGFjdE1hdGVyaWFsKHBsYXllckdyb3VuZENtKTtcclxuXHJcbiAgICAvLyA5LiBMaWdodGluZyBTZXR1cFxyXG4gICAgY29uc3QgYW1iaWVudExpZ2h0ID0gbmV3IFRIUkVFLkFtYmllbnRMaWdodChnYW1lQ29uZmlnLmxpZ2h0aW5nLmFtYmllbnRDb2xvcik7XHJcbiAgICBzY2VuZS5hZGQoYW1iaWVudExpZ2h0KTtcclxuXHJcbiAgICBjb25zdCBkaXJlY3Rpb25hbExpZ2h0ID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoZ2FtZUNvbmZpZy5saWdodGluZy5kaXJlY3Rpb25hbENvbG9yLCBnYW1lQ29uZmlnLmxpZ2h0aW5nLmRpcmVjdGlvbmFsSW50ZW5zaXR5KTtcclxuICAgIC8vIEZpeDogUGFzcyBpbmRpdmlkdWFsIGFyZ3VtZW50cyB0byBzZXQsIG5vdCBhIHNwcmVhZCBhcnJheVxyXG4gICAgZGlyZWN0aW9uYWxMaWdodC5wb3NpdGlvbi5zZXQoZ2FtZUNvbmZpZy5saWdodGluZy5kaXJlY3Rpb25hbFBvc2l0aW9uWzBdLCBnYW1lQ29uZmlnLmxpZ2h0aW5nLmRpcmVjdGlvbmFsUG9zaXRpb25bMV0sIGdhbWVDb25maWcubGlnaHRpbmcuZGlyZWN0aW9uYWxQb3NpdGlvblsyXSk7XHJcbiAgICBkaXJlY3Rpb25hbExpZ2h0LmNhc3RTaGFkb3cgPSB0cnVlO1xyXG4gICAgZGlyZWN0aW9uYWxMaWdodC5zaGFkb3cubWFwU2l6ZS53aWR0aCA9IDEwMjQ7XHJcbiAgICBkaXJlY3Rpb25hbExpZ2h0LnNoYWRvdy5tYXBTaXplLmhlaWdodCA9IDEwMjQ7XHJcbiAgICBkaXJlY3Rpb25hbExpZ2h0LnNoYWRvdy5jYW1lcmEubmVhciA9IDAuNTtcclxuICAgIGRpcmVjdGlvbmFsTGlnaHQuc2hhZG93LmNhbWVyYS5mYXIgPSA1MDtcclxuICAgIGRpcmVjdGlvbmFsTGlnaHQuc2hhZG93LmNhbWVyYS5sZWZ0ID0gLTIwO1xyXG4gICAgZGlyZWN0aW9uYWxMaWdodC5zaGFkb3cuY2FtZXJhLnJpZ2h0ID0gMjA7XHJcbiAgICBkaXJlY3Rpb25hbExpZ2h0LnNoYWRvdy5jYW1lcmEudG9wID0gMjA7XHJcbiAgICBkaXJlY3Rpb25hbExpZ2h0LnNoYWRvdy5jYW1lcmEuYm90dG9tID0gLTIwO1xyXG4gICAgc2NlbmUuYWRkKGRpcmVjdGlvbmFsTGlnaHQpO1xyXG5cclxuICAgIC8vIDEwLiBFdmVudCBMaXN0ZW5lcnNcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBvbldpbmRvd1Jlc2l6ZSk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgb25LZXlEb3duKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgb25LZXlVcCk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xpY2spOyAvLyBGb3IgdGl0bGUgc2NyZWVuIGludGVyYWN0aW9uIGFuZCBwb2ludGVyIGxvY2tcclxuXHJcbiAgICBtb3VzZVNlbnNpdGl2aXR5ID0gZ2FtZUNvbmZpZy5jYW1lcmEuc2Vuc2l0aXZpdHk7XHJcbiAgICBtaW5QaXRjaCA9IGdhbWVDb25maWcuY2FtZXJhLm1pblBpdGNoICogTWF0aC5QSSAvIDE4MDtcclxuICAgIG1heFBpdGNoID0gZ2FtZUNvbmZpZy5jYW1lcmEubWF4UGl0Y2ggKiBNYXRoLlBJIC8gMTgwO1xyXG5cclxuICAgIHNob3dUaXRsZVNjcmVlbigpO1xyXG59XHJcblxyXG4vKipcclxuICogRGlzcGxheXMgdGhlIHRpdGxlIHNjcmVlbiBvdmVybGF5LlxyXG4gKi9cclxuZnVuY3Rpb24gc2hvd1RpdGxlU2NyZWVuKCkge1xyXG4gICAgZ2FtZVN0YXRlID0gR2FtZVN0YXRlLlRJVExFO1xyXG4gICAgaWYgKCF0aXRsZVNjcmVlbkRpdikge1xyXG4gICAgICAgIHRpdGxlU2NyZWVuRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgdGl0bGVTY3JlZW5EaXYuaWQgPSAndGl0bGVTY3JlZW4nO1xyXG4gICAgICAgIHRpdGxlU2NyZWVuRGl2LnN0eWxlLmNzc1RleHQgPSBgXHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICAgICAgdG9wOiAwOyBsZWZ0OiAwO1xyXG4gICAgICAgICAgICB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlO1xyXG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogJHtnYW1lQ29uZmlnLnRpdGxlU2NyZWVuLmJhY2tncm91bmRDb2xvcn07XHJcbiAgICAgICAgICAgIGNvbG9yOiAke2dhbWVDb25maWcudGl0bGVTY3JlZW4uZm9udENvbG9yfTtcclxuICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdBcmlhbCcsIHNhbnMtc2VyaWY7XHJcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogJHtnYW1lQ29uZmlnLnRpdGxlU2NyZWVuLmZvbnRTaXplfTtcclxuICAgICAgICAgICAgei1pbmRleDogMTAwO1xyXG4gICAgICAgIGA7XHJcblxyXG4gICAgICAgIGNvbnN0IHRpdGxlVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gxJyk7XHJcbiAgICAgICAgdGl0bGVUZXh0LnRleHRDb250ZW50ID0gZ2FtZUNvbmZpZy5nYW1lVGl0bGU7XHJcbiAgICAgICAgdGl0bGVUZXh0LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcyMHB4JztcclxuICAgICAgICB0aXRsZVNjcmVlbkRpdi5hcHBlbmRDaGlsZCh0aXRsZVRleHQpO1xyXG5cclxuICAgICAgICBjb25zdCBjbGlja1RvU3RhcnRUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgICAgIGNsaWNrVG9TdGFydFRleHQudGV4dENvbnRlbnQgPSBnYW1lQ29uZmlnLnRpdGxlU2NyZWVuLm1lc3NhZ2U7XHJcbiAgICAgICAgdGl0bGVTY3JlZW5EaXYuYXBwZW5kQ2hpbGQoY2xpY2tUb1N0YXJ0VGV4dCk7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGl0bGVTY3JlZW5EaXYpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aXRsZVNjcmVlbkRpdi5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogSGlkZXMgdGhlIHRpdGxlIHNjcmVlbiBhbmQgc3RhcnRzIHRoZSBnYW1lLlxyXG4gKi9cclxuZnVuY3Rpb24gaGlkZVRpdGxlU2NyZWVuKCkge1xyXG4gICAgaWYgKHRpdGxlU2NyZWVuRGl2KSB7XHJcbiAgICAgICAgdGl0bGVTY3JlZW5EaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgIH1cclxuICAgIGdhbWVTdGF0ZSA9IEdhbWVTdGF0ZS5QTEFZSU5HO1xyXG4gICAgLy8gUmVxdWVzdCBwb2ludGVyIGxvY2sgZm9yIGNvbnRpbnVvdXMgbW91c2UgaW5wdXRcclxuICAgIGNhbnZhcy5yZXF1ZXN0UG9pbnRlckxvY2sgPSBjYW52YXMucmVxdWVzdFBvaW50ZXJMb2NrIHx8IChjYW52YXMgYXMgYW55KS5tb3pSZXF1ZXN0UG9pbnRlckxvY2s7XHJcbiAgICBjYW52YXMucmVxdWVzdFBvaW50ZXJMb2NrKCk7XHJcbiAgICBzdGFydEF1ZGlvKCk7IC8vIFN0YXJ0IGJhY2tncm91bmQgbXVzaWNcclxuICAgIGxhc3RUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7IC8vIEluaXRpYWxpemUgbGFzdFRpbWUgZm9yIHRoZSBnYW1lIGxvb3BcclxuICAgIGFuaW1hdGUoKTsgLy8gU3RhcnQgdGhlIGdhbWUgbG9vcFxyXG59XHJcblxyXG4vKipcclxuICogU3RhcnRzIGJhY2tncm91bmQgYXVkaW8gcGxheWJhY2suXHJcbiAqL1xyXG5mdW5jdGlvbiBzdGFydEF1ZGlvKCkge1xyXG4gICAgaWYgKGJnTXVzaWMgJiYgYmdNdXNpYy5pc1BsYXlpbmcpIHtcclxuICAgICAgICByZXR1cm47IC8vIEFscmVhZHkgcGxheWluZ1xyXG4gICAgfVxyXG5cclxuICAgIGF1ZGlvTG9hZGVyLmxvYWQoZ2FtZUNvbmZpZy5hdWRpby5iYWNrZ3JvdW5kTXVzaWMsIGZ1bmN0aW9uKGJ1ZmZlcikge1xyXG4gICAgICAgIGJnTXVzaWMgPSBuZXcgVEhSRUUuQXVkaW8oYXVkaW9MaXN0ZW5lcik7XHJcbiAgICAgICAgYmdNdXNpYy5zZXRCdWZmZXIoYnVmZmVyKTtcclxuICAgICAgICBiZ011c2ljLnNldExvb3AodHJ1ZSk7XHJcbiAgICAgICAgYmdNdXNpYy5zZXRWb2x1bWUoZ2FtZUNvbmZpZy5hdWRpby52b2x1bWUpO1xyXG4gICAgICAgIGJnTXVzaWMucGxheSgpO1xyXG4gICAgfSwgdW5kZWZpbmVkLCAoZXJyKSA9PiBjb25zb2xlLndhcm4oJ0Vycm9yIGxvYWRpbmcgYmFja2dyb3VuZCBtdXNpYzonLCBlcnIsICdBdWRpbyB3aWxsIG5vdCBwbGF5LicpKTtcclxufVxyXG5cclxuLy8gLS0tIEV2ZW50IEhhbmRsZXJzIC0tLVxyXG5cclxuZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoKSB7XHJcbiAgICBjYW1lcmEuYXNwZWN0ID0gd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcbiAgICBjYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xyXG4gICAgcmVuZGVyZXIuc2V0U2l6ZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gb25LZXlEb3duKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XHJcbiAgICBpZiAoZ2FtZVN0YXRlICE9PSBHYW1lU3RhdGUuUExBWUlORykgcmV0dXJuO1xyXG4gICAgc3dpdGNoIChldmVudC5jb2RlKSB7XHJcbiAgICAgICAgY2FzZSAnS2V5Vyc6IGtleXMudyA9IHRydWU7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ0tleUEnOiBrZXlzLmEgPSB0cnVlOyBicmVhaztcclxuICAgICAgICBjYXNlICdLZXlTJzoga2V5cy5zID0gdHJ1ZTsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnS2V5RCc6IGtleXMuZCA9IHRydWU7IGJyZWFrO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBvbktleVVwKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XHJcbiAgICBpZiAoZ2FtZVN0YXRlICE9PSBHYW1lU3RhdGUuUExBWUlORykgcmV0dXJuO1xyXG4gICAgc3dpdGNoIChldmVudC5jb2RlKSB7XHJcbiAgICAgICAgY2FzZSAnS2V5Vyc6IGtleXMudyA9IGZhbHNlOyBicmVhaztcclxuICAgICAgICBjYXNlICdLZXlBJzoga2V5cy5hID0gZmFsc2U7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ0tleVMnOiBrZXlzLnMgPSBmYWxzZTsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnS2V5RCc6IGtleXMuZCA9IGZhbHNlOyBicmVhaztcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gb25Nb3VzZU1vdmUoZXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgIC8vIE9ubHkgcHJvY2VzcyBtb3VzZSBtb3ZlbWVudCBpZiBnYW1lIGlzIHBsYXlpbmcgYW5kIHBvaW50ZXIgaXMgbG9ja2VkXHJcbiAgICBpZiAoZ2FtZVN0YXRlICE9PSBHYW1lU3RhdGUuUExBWUlORyB8fCBkb2N1bWVudC5wb2ludGVyTG9ja0VsZW1lbnQgIT09IGNhbnZhcykgcmV0dXJuO1xyXG5cclxuICAgIG1vdXNlWWF3IC09IGV2ZW50Lm1vdmVtZW50WCAqIG1vdXNlU2Vuc2l0aXZpdHk7IC8vIEhvcml6b250YWwgcm90YXRpb25cclxuICAgIG1vdXNlUGl0Y2ggLT0gZXZlbnQubW92ZW1lbnRZICogbW91c2VTZW5zaXRpdml0eTsgLy8gVmVydGljYWwgcm90YXRpb25cclxuXHJcbiAgICAvLyBDbGFtcCBwaXRjaCB0byBwcmV2ZW50IGNhbWVyYSBmcm9tIGZsaXBwaW5nIG92ZXJcclxuICAgIG1vdXNlUGl0Y2ggPSBNYXRoLm1heChtaW5QaXRjaCwgTWF0aC5taW4obWF4UGl0Y2gsIG1vdXNlUGl0Y2gpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gb25DbGljaygpIHtcclxuICAgIGlmIChnYW1lU3RhdGUgPT09IEdhbWVTdGF0ZS5USVRMRSkge1xyXG4gICAgICAgIGhpZGVUaXRsZVNjcmVlbigpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gR2FtZSBMb29wIC0tLVxyXG5cclxuLyoqXHJcbiAqIE1haW4gYW5pbWF0aW9uIGxvb3AgZm9yIHVwZGF0aW5nIGdhbWUgc3RhdGUgYW5kIHJlbmRlcmluZy5cclxuICovXHJcbmZ1bmN0aW9uIGFuaW1hdGUoKSB7XHJcbiAgICBhbmltYXRpb25GcmFtZUlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xyXG5cclxuICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgICBjb25zdCBkZWx0YVRpbWUgPSAoY3VycmVudFRpbWUgLSBsYXN0VGltZSkgLyAxMDAwOyAvLyBEZWx0YSB0aW1lIGluIHNlY29uZHNcclxuICAgIGxhc3RUaW1lID0gY3VycmVudFRpbWU7XHJcblxyXG4gICAgaWYgKGdhbWVTdGF0ZSA9PT0gR2FtZVN0YXRlLlBMQVlJTkcpIHtcclxuICAgICAgICAvLyBVcGRhdGUgcGh5c2ljcyB3b3JsZFxyXG4gICAgICAgIHdvcmxkLnN0ZXAoMSAvIDYwLCBkZWx0YVRpbWUsIDMpOyAvLyBGaXhlZCB0aW1lIHN0ZXAsIGRlbHRhIGZvciBpbnRlcnBvbGF0aW9uXHJcblxyXG4gICAgICAgIC8vIDEuIFBsYXllciBNb3ZlbWVudCBMb2dpY1xyXG4gICAgICAgIGNvbnN0IHBsYXllclNwZWVkID0gZ2FtZUNvbmZpZy5wbGF5ZXIuc3BlZWQ7XHJcbiAgICAgICAgY29uc3QgcGxheWVyTWFzcyA9IGdhbWVDb25maWcucGxheWVyLm1hc3M7XHJcbiAgICAgICAgY29uc3QgaW5wdXRWZWN0b3IgPSBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAwKTtcclxuXHJcbiAgICAgICAgLy8gRGV0ZXJtaW5lIGlucHV0IGRpcmVjdGlvblxyXG4gICAgICAgIGlmIChrZXlzLncpIGlucHV0VmVjdG9yLnogLT0gMTtcclxuICAgICAgICBpZiAoa2V5cy5zKSBpbnB1dFZlY3Rvci56ICs9IDE7XHJcbiAgICAgICAgaWYgKGtleXMuYSkgaW5wdXRWZWN0b3IueCAtPSAxO1xyXG4gICAgICAgIGlmIChrZXlzLmQpIGlucHV0VmVjdG9yLnggKz0gMTtcclxuXHJcbiAgICAgICAgaWYgKGlucHV0VmVjdG9yLmxlbmd0aFNxKCkgPiAwKSB7XHJcbiAgICAgICAgICAgIGlucHV0VmVjdG9yLm5vcm1hbGl6ZSgpOyAvLyBOb3JtYWxpemUgZm9yIGNvbnNpc3RlbnQgc3BlZWQgd2hlbiBtb3ZpbmcgZGlhZ29uYWxseVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2FsY3VsYXRlIG1vdmVtZW50IGRpcmVjdGlvbiByZWxhdGl2ZSB0byBjYW1lcmEncyB5YXdcclxuICAgICAgICBjb25zdCBmb3J3YXJkVmVjdG9yID0gbmV3IFRIUkVFLlZlY3RvcjMoMCwgMCwgLTEpO1xyXG4gICAgICAgIGZvcndhcmRWZWN0b3IuYXBwbHlBeGlzQW5nbGUobmV3IFRIUkVFLlZlY3RvcjMoMCwgMSwgMCksIG1vdXNlWWF3KTtcclxuXHJcbiAgICAgICAgY29uc3QgcmlnaHRWZWN0b3IgPSBuZXcgVEhSRUUuVmVjdG9yMygxLCAwLCAwKTtcclxuICAgICAgICByaWdodFZlY3Rvci5hcHBseUF4aXNBbmdsZShuZXcgVEhSRUUuVmVjdG9yMygwLCAxLCAwKSwgbW91c2VZYXcpO1xyXG5cclxuICAgICAgICBjb25zdCBtb3ZlRGlyZWN0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcclxuICAgICAgICBtb3ZlRGlyZWN0aW9uLmFkZFNjYWxlZFZlY3Rvcihmb3J3YXJkVmVjdG9yLCBpbnB1dFZlY3Rvci56KTtcclxuICAgICAgICBtb3ZlRGlyZWN0aW9uLmFkZFNjYWxlZFZlY3RvcihyaWdodFZlY3RvciwgaW5wdXRWZWN0b3IueCk7XHJcblxyXG4gICAgICAgIC8vIEFwcGx5IGltcHVsc2UgdG8gcGxheWVyIGJvZHkgKGlnbm9yaW5nIFkgZm9yIGhvcml6b250YWwgbW92ZW1lbnQpXHJcbiAgICAgICAgY29uc3QgY3VycmVudFZlbG9jaXR5ID0gcGxheWVyQm9keS52ZWxvY2l0eTtcclxuICAgICAgICBjb25zdCBkZXNpcmVkVmVsb2NpdHkgPSBuZXcgQ0FOTk9OLlZlYzMobW92ZURpcmVjdGlvbi54ICogcGxheWVyU3BlZWQsIGN1cnJlbnRWZWxvY2l0eS55LCBtb3ZlRGlyZWN0aW9uLnogKiBwbGF5ZXJTcGVlZCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSW1wdWxzZSA9ICh0YXJnZXRfdmVsb2NpdHkgLSBjdXJyZW50X3ZlbG9jaXR5KSAqIG1hc3NcclxuICAgICAgICBjb25zdCBpbXB1bHNlID0gZGVzaXJlZFZlbG9jaXR5LnZzdWIoY3VycmVudFZlbG9jaXR5KS5zY2FsZShwbGF5ZXJNYXNzKTtcclxuICAgICAgICBwbGF5ZXJCb2R5LmFwcGx5SW1wdWxzZShpbXB1bHNlKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBEYW1wZW4gaG9yaXpvbnRhbCB2ZWxvY2l0eSB0byBwcmV2ZW50IGluZGVmaW5pdGUgc2xpZGluZy9zcGVlZCBidWlsZHVwXHJcbiAgICAgICAgY29uc3QgbWF4SG9yaXpvbnRhbFNwZWVkID0gcGxheWVyU3BlZWQgKiAxLjU7IC8vIEFsbG93IHNsaWdodCBvdmVyc2hvb3QgZm9yIG1vcmUgcmVzcG9uc2l2ZSBmZWVsXHJcbiAgICAgICAgY29uc3QgY3VycmVudEhvcml6b250YWxTcGVlZFNxID0gY3VycmVudFZlbG9jaXR5LnggKiBjdXJyZW50VmVsb2NpdHkueCArIGN1cnJlbnRWZWxvY2l0eS56ICogY3VycmVudFZlbG9jaXR5Lno7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRIb3Jpem9udGFsU3BlZWRTcSA+IG1heEhvcml6b250YWxTcGVlZCAqIG1heEhvcml6b250YWxTcGVlZCkge1xyXG4gICAgICAgICAgICBjb25zdCBzY2FsZSA9IG1heEhvcml6b250YWxTcGVlZCAvIE1hdGguc3FydChjdXJyZW50SG9yaXpvbnRhbFNwZWVkU3EpO1xyXG4gICAgICAgICAgICBwbGF5ZXJCb2R5LnZlbG9jaXR5LnggKj0gc2NhbGU7XHJcbiAgICAgICAgICAgIHBsYXllckJvZHkudmVsb2NpdHkueiAqPSBzY2FsZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFVwZGF0ZSBwbGF5ZXIgbWVzaCBwb3NpdGlvbiBhbmQgcm90YXRpb25cclxuICAgICAgICBwbGF5ZXJNZXNoLnBvc2l0aW9uLmNvcHkocGxheWVyQm9keS5wb3NpdGlvbiBhcyBhbnkpO1xyXG4gICAgICAgIC8vIFBsYXllciBtZXNoIHNob3VsZCB2aXN1YWxseSB0dXJuIHdpdGggdGhlIGNhbWVyYSdzIHlhd1xyXG4gICAgICAgIHBsYXllck1lc2gucXVhdGVybmlvbi5zZXRGcm9tQXhpc0FuZ2xlKG5ldyBUSFJFRS5WZWN0b3IzKDAsIDEsIDApLCBtb3VzZVlhdyk7XHJcblxyXG4gICAgICAgIC8vIDIuIENhbWVyYSBQb3NpdGlvbmluZyBhbmQgUm90YXRpb25cclxuICAgICAgICBjb25zdCBwbGF5ZXJXb3JsZFBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMocGxheWVyQm9keS5wb3NpdGlvbi54LCBwbGF5ZXJCb2R5LnBvc2l0aW9uLnksIHBsYXllckJvZHkucG9zaXRpb24ueik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2FsY3VsYXRlIGNhbWVyYSdzIHJlbGF0aXZlIG9mZnNldCBmcm9tIHBsYXllclxyXG4gICAgICAgIGNvbnN0IGNhbWVyYVJlbGF0aXZlT2Zmc2V0ID0gbmV3IFRIUkVFLlZlY3RvcjMoXHJcbiAgICAgICAgICAgIGdhbWVDb25maWcuY2FtZXJhLm9mZnNldFgsXHJcbiAgICAgICAgICAgIGdhbWVDb25maWcuY2FtZXJhLm9mZnNldFksXHJcbiAgICAgICAgICAgIGdhbWVDb25maWcuY2FtZXJhLm9mZnNldFpcclxuICAgICAgICApOyAvLyBUaGlzIGlzIHRoZSBiYXNlIG9mZnNldCAoZS5nLiwgLVogbWVhbnMgYmVoaW5kKVxyXG5cclxuICAgICAgICAvLyBSb3RhdGUgdGhlIG9mZnNldCBieSB0aGUgeWF3IHRvIGtlZXAgaXQgYmVoaW5kIHRoZSBwbGF5ZXJcclxuICAgICAgICBjYW1lcmFSZWxhdGl2ZU9mZnNldC5hcHBseUF4aXNBbmdsZShuZXcgVEhSRUUuVmVjdG9yMygwLCAxLCAwKSwgbW91c2VZYXcpO1xyXG5cclxuICAgICAgICAvLyBTZXQgY2FtZXJhIHBvc2l0aW9uIGJ5IGFkZGluZyB0aGUgcm90YXRlZCBvZmZzZXQgdG8gcGxheWVyJ3MgcG9zaXRpb25cclxuICAgICAgICBjYW1lcmEucG9zaXRpb24uY29weShwbGF5ZXJXb3JsZFBvc2l0aW9uKS5hZGQoY2FtZXJhUmVsYXRpdmVPZmZzZXQpO1xyXG5cclxuICAgICAgICAvLyBTZXQgY2FtZXJhIHJvdGF0aW9uIGJhc2VkIG9uIG1vdXNlIHlhdyBhbmQgcGl0Y2hcclxuICAgICAgICBjb25zdCB0ZW1wUXVhdGVybmlvbiA9IG5ldyBUSFJFRS5RdWF0ZXJuaW9uKCk7XHJcbiAgICAgICAgY29uc3QgdGVtcFZlY3RvciA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XHJcblxyXG4gICAgICAgIC8vIEZpcnN0IGFwcGx5IFlhdyByb3RhdGlvblxyXG4gICAgICAgIHRlbXBRdWF0ZXJuaW9uLnNldEZyb21BeGlzQW5nbGUodGVtcFZlY3Rvci5zZXQoMCwgMSwgMCksIG1vdXNlWWF3KTtcclxuICAgICAgICBjYW1lcmEucXVhdGVybmlvbi5jb3B5KHRlbXBRdWF0ZXJuaW9uKTtcclxuXHJcbiAgICAgICAgLy8gVGhlbiBhcHBseSBQaXRjaCByb3RhdGlvbiAocmVsYXRpdmUgdG8gdGhlIHlhdylcclxuICAgICAgICB0ZW1wUXVhdGVybmlvbi5zZXRGcm9tQXhpc0FuZ2xlKHRlbXBWZWN0b3Iuc2V0KDEsIDAsIDApLCBtb3VzZVBpdGNoKTtcclxuICAgICAgICBjYW1lcmEucXVhdGVybmlvbi5tdWx0aXBseVF1YXRlcm5pb25zKGNhbWVyYS5xdWF0ZXJuaW9uLCB0ZW1wUXVhdGVybmlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVuZGVyIHRoZSBzY2VuZSB3aXRoIHRoZSBjYW1lcmFcclxuICAgIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgY2FtZXJhKTtcclxufVxyXG5cclxuLy8gU3RhcnQgdGhlIGdhbWUgYnkgZmV0Y2hpbmcgY29uZmlndXJhdGlvblxyXG5mZXRjaENvbmZpZ0FuZEluaXQoKTtcclxuXHJcbi8vIExpc3RlbiBmb3IgcG9pbnRlciBsb2NrIGNoYW5nZSBldmVudHMgdG8gcGF1c2UvdW5wYXVzZSBtb3VzZSBpbnB1dFxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVybG9ja2NoYW5nZScsICgpID0+IHtcclxuICAgIGlmIChkb2N1bWVudC5wb2ludGVyTG9ja0VsZW1lbnQgPT09IGNhbnZhcykge1xyXG4gICAgICAgIC8vIFBvaW50ZXIgaXMgbG9ja2VkLCBnYW1lIGlzIGFjdGl2ZVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBQb2ludGVyIGlzIHVubG9ja2VkLCB1c2VyIHByb2JhYmx5IHByZXNzZWQgRVNDLiBPcHRpb25hbGx5IHBhdXNlIHRoZSBnYW1lIG9yIHNob3cgYSBtZW51LlxyXG4gICAgICAgIC8vIEZvciB0aGlzIHNpbXBsZSBnYW1lLCB3ZSBqdXN0IHN0b3Ag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LGtCQUFjLGdCQUFnQixhQUFhLFlBQVksQ0FBQztBQUd4RCxVQUFNLGtCQUFrQixXQUFXO0FBQ25DLFVBQU0sa0JBQWtCLElBQUksT0FBTyxLQUFLLGNBQWMsSUFBSSxhQUFhLGdCQUFnQixHQUFHLGNBQWMsSUFBSSxXQUFXO0FBR3ZILFVBQU0sVUFBVSxnQkFBZ0IsS0FBSyxlQUFlLEVBQUUsTUFBTSxVQUFVO0FBQ3RFLGVBQVcsYUFBYSxPQUFPO0FBRy9CLFVBQU0scUJBQXFCLGNBQWM7QUFDekMsVUFBTSwyQkFBMkIsZ0JBQWdCLElBQUksZ0JBQWdCLElBQUksZ0JBQWdCLElBQUksZ0JBQWdCO0FBQzdHLFFBQUksMkJBQTJCLHFCQUFxQixvQkFBb0I7QUFDcEUsWUFBTSxRQUFRLHFCQUFxQixLQUFLLEtBQUssd0JBQXdCO0FBQ3JFLGlCQUFXLFNBQVMsS0FBSztBQUN6QixpQkFBVyxTQUFTLEtBQUs7QUFBQSxJQUM3QjtBQUdBLGVBQVcsU0FBUyxLQUFLLFdBQVcsUUFBZTtBQUVuRCxlQUFXLFdBQVcsaUJBQWlCLElBQUksTUFBTSxRQUFRLEdBQUcsR0FBRyxDQUFDLEdBQUcsUUFBUTtBQUczRSxVQUFNLHNCQUFzQixJQUFJLE1BQU0sUUFBUSxXQUFXLFNBQVMsR0FBRyxXQUFXLFNBQVMsR0FBRyxXQUFXLFNBQVMsQ0FBQztBQUdqSCxVQUFNLHVCQUF1QixJQUFJLE1BQU07QUFBQSxNQUNuQyxXQUFXLE9BQU87QUFBQSxNQUNsQixXQUFXLE9BQU87QUFBQSxNQUNsQixXQUFXLE9BQU87QUFBQSxJQUN0QjtBQUdBLHlCQUFxQixlQUFlLElBQUksTUFBTSxRQUFRLEdBQUcsR0FBRyxDQUFDLEdBQUcsUUFBUTtBQUd4RSxXQUFPLFNBQVMsS0FBSyxtQkFBbUIsRUFBRSxJQUFJLG9CQUFvQjtBQUdsRSxVQUFNLGlCQUFpQixJQUFJLE1BQU0sV0FBVztBQUM1QyxVQUFNLGFBQWEsSUFBSSxNQUFNLFFBQVE7QUFHckMsbUJBQWUsaUJBQWlCLFdBQVcsSUFBSSxHQUFHLEdBQUcsQ0FBQyxHQUFHLFFBQVE7QUFDakUsV0FBTyxXQUFXLEtBQUssY0FBYztBQUdyQyxtQkFBZSxpQkFBaUIsV0FBVyxJQUFJLEdBQUcsR0FBRyxDQUFDLEdBQUcsVUFBVTtBQUNuRSxXQUFPLFdBQVcsb0JBQW9CLE9BQU8sWUFBWSxjQUFjO0FBQUEsRUFDM0U7QUFHQSxXQUFTLE9BQU8sT0FBTyxNQUFNO0FBQ2pDO0FBR0EsbUJBQW1CO0FBR25CLFNBQVMsaUJBQWlCLHFCQUFxQixNQUFNO0FBQ2pELE1BQUksU0FBUyx1QkFBdUIsUUFBUTtBQUFBLEVBRTVDLE9BQU87QUFBQSxFQUdQO0FBQ0osQ0FBQzsiLAogICJuYW1lcyI6IFsiR2FtZVN0YXRlIl0KfQo=
