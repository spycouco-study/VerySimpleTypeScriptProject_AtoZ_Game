let config;
let loadedAssets;
let canvas;
let ctx;
let gameState = "TITLE";
let snake;
let food;
let score;
let currentDirection;
let nextDirection;
let gameIntervalId;
const KEY_SPACE = " ";
const KEY_ENTER = "Enter";
const KEY_W = "w";
const KEY_A = "a";
const KEY_S = "s";
const KEY_D = "d";
const KEY_UP = "ArrowUp";
const KEY_LEFT = "ArrowLeft";
const KEY_DOWN = "ArrowDown";
const KEY_RIGHT = "ArrowRight";
async function initGame() {
  canvas = document.getElementById("gameCanvas");
  if (!canvas) {
    console.error('Canvas element with ID "gameCanvas" not found.');
    return;
  }
  ctx = canvas.getContext("2d");
  try {
    const response = await fetch("data.json");
    config = await response.json();
    canvas.width = config.canvasWidth;
    canvas.height = config.canvasHeight;
    loadedAssets = await loadAssets(config.assets);
    setupEventListeners();
    resetGame();
    gameLoop();
  } catch (error) {
    console.error("Failed to load game configuration or assets:", error);
  }
}
async function loadAssets(assetConfig) {
  const imagePromises = assetConfig.images.map((img) => {
    return new Promise((resolve, reject) => {
      const image = new Image();
      image.src = img.path;
      image.onload = () => resolve([img.name, image]);
      image.onerror = () => reject(`Failed to load image: ${img.path}`);
    });
  });
  const soundPromises = assetConfig.sounds.map((snd) => {
    return new Promise((resolve, reject) => {
      const audio = new Audio();
      audio.src = snd.path;
      audio.volume = snd.volume;
      audio.loop = snd.name === "bgm";
      audio.oncanplaythrough = () => resolve([snd.name, audio]);
      audio.onerror = () => reject(`Failed to load sound: ${snd.path}`);
    });
  });
  const loadedImages = await Promise.all(imagePromises);
  const loadedSounds = await Promise.all(soundPromises);
  const imagesMap = {};
  loadedImages.forEach(([name, img]) => imagesMap[name] = img);
  const soundsMap = {};
  loadedSounds.forEach(([name, audio]) => soundsMap[name] = audio);
  return { images: imagesMap, sounds: soundsMap };
}
function setupEventListeners() {
  document.addEventListener("keydown", handleKeyDown);
}
function handleKeyDown(event) {
  const key = event.key;
  if (gameState === "TITLE" || gameState === "CONTROLS" || gameState === "GAME_OVER") {
    if (key === KEY_SPACE || key === KEY_ENTER) {
      event.preventDefault();
      if (gameState === "TITLE") {
        gameState = "CONTROLS";
        playBGM();
      } else if (gameState === "CONTROLS") {
        gameState = "PLAYING";
        startGameInterval();
      } else if (gameState === "GAME_OVER") {
        resetGame();
        gameState = "TITLE";
        stopBGM();
      }
    }
  }
  if (gameState === "PLAYING") {
    let newDirection = null;
    switch (key) {
      case KEY_UP:
      case KEY_W:
        newDirection = "UP";
        break;
      case KEY_DOWN:
      case KEY_S:
        newDirection = "DOWN";
        break;
      case KEY_LEFT:
      case KEY_A:
        newDirection = "LEFT";
        break;
      case KEY_RIGHT:
      case KEY_D:
        newDirection = "RIGHT";
        break;
    }
    if (newDirection) {
      if (!(newDirection === "UP" && currentDirection === "DOWN" || newDirection === "DOWN" && currentDirection === "UP" || newDirection === "LEFT" && currentDirection === "RIGHT" || newDirection === "RIGHT" && currentDirection === "LEFT")) {
        nextDirection = newDirection;
      }
      event.preventDefault();
    }
  }
}
function resetGame() {
  snake = [];
  for (let i = 0; i < config.initialSnakeLength; i++) {
    snake.push({ x: Math.floor(config.canvasWidth / 2 / config.gridSize), y: Math.floor(config.canvasHeight / 2 / config.gridSize) + i });
  }
  currentDirection = "UP";
  nextDirection = "UP";
  score = 0;
  generateFood();
  stopGameInterval();
  if (gameState === "GAME_OVER") {
    stopBGM();
  }
}
function startGameInterval() {
  if (gameIntervalId) {
    clearInterval(gameIntervalId);
  }
  gameIntervalId = setInterval(gameTick, config.gameSpeedMs);
  playBGM();
}
function stopGameInterval() {
  if (gameIntervalId) {
    clearInterval(gameIntervalId);
    gameIntervalId = void 0;
  }
}
function gameTick() {
  if (gameState !== "PLAYING") return;
  currentDirection = nextDirection;
  const head = { ...snake[0] };
  switch (currentDirection) {
    case "UP":
      head.y--;
      break;
    case "DOWN":
      head.y++;
      break;
    case "LEFT":
      head.x--;
      break;
    case "RIGHT":
      head.x++;
      break;
  }
  if (head.x < 0 || head.x >= config.canvasWidth / config.gridSize || head.y < 0 || head.y >= config.canvasHeight / config.gridSize || checkSelfCollision(head)) {
    endGame();
    return;
  }
  snake.unshift(head);
  if (head.x === food.x && head.y === food.y) {
    score += config.scorePerFood;
    loadedAssets.sounds["eat_food"]?.play();
    generateFood();
  } else {
    snake.pop();
  }
}
function checkSelfCollision(head) {
  for (let i = 1; i < snake.length; i++) {
    if (head.x === snake[i].x && head.y === snake[i].y) {
      return true;
    }
  }
  return false;
}
function generateFood() {
  let newFood;
  const maxX = config.canvasWidth / config.gridSize;
  const maxY = config.canvasHeight / config.gridSize;
  do {
    newFood = {
      x: Math.floor(Math.random() * maxX),
      y: Math.floor(Math.random() * maxY)
    };
  } while (isOccupiedBySnake(newFood));
  food = newFood;
}
function isOccupiedBySnake(segment) {
  return snake.some((s) => s.x === segment.x && s.y === segment.y);
}
function endGame() {
  gameState = "GAME_OVER";
  stopGameInterval();
  loadedAssets.sounds["game_over"]?.play();
  stopBGM();
}
function playBGM() {
  const bgm = loadedAssets.sounds["bgm"];
  if (bgm && bgm.paused) {
    bgm.currentTime = 0;
    bgm.play().catch((e) => console.warn("BGM autoplay prevented:", e));
  }
}
function stopBGM() {
  const bgm = loadedAssets.sounds["bgm"];
  if (bgm && !bgm.paused) {
    bgm.pause();
  }
}
function gameLoop() {
  draw();
  requestAnimationFrame(gameLoop);
}
function draw() {
  ctx.clearRect(0, 0, config.canvasWidth, config.canvasHeight);
  const bgImage = loadedAssets.images["background"];
  if (bgImage) {
    ctx.drawImage(bgImage, 0, 0, config.canvasWidth, config.canvasHeight);
  } else {
    ctx.fillStyle = "#1a1a2e";
    ctx.fillRect(0, 0, config.canvasWidth, config.canvasHeight);
  }
  if (gameState === "TITLE") {
    drawTitleScreen();
  } else if (gameState === "CONTROLS") {
    drawControlsScreen();
  } else if (gameState === "PLAYING") {
    drawPlayingState();
  } else if (gameState === "GAME_OVER") {
    drawGameOverScreen();
  }
}
function drawTitleScreen() {
  ctx.fillStyle = config.titleScreenText.color;
  ctx.font = config.uiFont;
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText(config.titleScreenText.title, config.canvasWidth / 2, config.canvasHeight / 2 - 50);
  ctx.font = config.smallUiFont;
  ctx.fillText(config.titleScreenText.subtitle, config.canvasWidth / 2, config.canvasHeight / 2 + 20);
}
function drawControlsScreen() {
  ctx.fillStyle = config.controlsScreenText.color;
  ctx.font = config.uiFont;
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText(config.controlsScreenText.title, config.canvasWidth / 2, config.canvasHeight / 2 - 120);
  ctx.font = config.smallUiFont;
  ctx.fillText(config.controlsScreenText.moveText, config.canvasWidth / 2, config.canvasHeight / 2 - 40);
  ctx.fillText(config.controlsScreenText.objectiveText, config.canvasWidth / 2, config.canvasHeight / 2);
  ctx.fillText(config.controlsScreenText.warningText, config.canvasWidth / 2, config.canvasHeight / 2 + 40);
  ctx.fillText(config.controlsScreenText.continueText, config.canvasWidth / 2, config.canvasHeight / 2 + 120);
}
function drawPlayingState() {
  const foodImage = loadedAssets.images["food"];
  if (foodImage) {
    ctx.drawImage(foodImage, food.x * config.gridSize, food.y * config.gridSize, config.gridSize, config.gridSize);
  } else {
    ctx.fillStyle = "orange";
    ctx.fillRect(food.x * config.gridSize, food.y * config.gridSize, config.gridSize, config.gridSize);
  }
  for (let i = 0; i < snake.length; i++) {
    const segment = snake[i];
    const assetName = i === 0 ? "snake_head" : "snake_body";
    const image = loadedAssets.images[assetName];
    if (image) {
      ctx.drawImage(image, segment.x * config.gridSize, segment.y * config.gridSize, config.gridSize, config.gridSize);
    } else {
      ctx.fillStyle = i === 0 ? "#00FF00" : "#00AA00";
      ctx.fillRect(segment.x * config.gridSize, segment.y * config.gridSize, config.gridSize, config.gridSize);
    }
  }
  ctx.fillStyle = config.scoreDisplayColor;
  ctx.font = config.smallUiFont;
  ctx.textAlign = "left";
  ctx.textBaseline = "top";
  ctx.fillText(`\uC810\uC218: ${score}`, 10, 10);
}
function drawGameOverScreen() {
  ctx.fillStyle = config.gameOverScreenText.color;
  ctx.font = config.uiFont;
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText(config.gameOverScreenText.title, config.canvasWidth / 2, config.canvasHeight / 2 - 50);
  ctx.font = config.smallUiFont;
  ctx.fillText(`${config.gameOverScreenText.subtitle} ${score}`, config.canvasWidth / 2, config.canvasHeight / 2);
  ctx.fillText(config.gameOverScreenText.restartText, config.canvasWidth / 2, config.canvasHeight / 2 + 50);
}
document.addEventListener("DOMContentLoaded", initGame);
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiZ2FtZS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW50ZXJmYWNlIEdhbWVDb25maWcge1xyXG4gICAgY2FudmFzV2lkdGg6IG51bWJlcjtcclxuICAgIGNhbnZhc0hlaWdodDogbnVtYmVyO1xyXG4gICAgZ3JpZFNpemU6IG51bWJlcjtcclxuICAgIGluaXRpYWxTbmFrZUxlbmd0aDogbnVtYmVyO1xyXG4gICAgZ2FtZVNwZWVkTXM6IG51bWJlcjtcclxuICAgIHNjb3JlUGVyRm9vZDogbnVtYmVyO1xyXG4gICAgdWlGb250OiBzdHJpbmc7XHJcbiAgICBzbWFsbFVpRm9udDogc3RyaW5nO1xyXG4gICAgdGl0bGVTY3JlZW5UZXh0OiB7XHJcbiAgICAgICAgdGl0bGU6IHN0cmluZztcclxuICAgICAgICBzdWJ0aXRsZTogc3RyaW5nO1xyXG4gICAgICAgIGNvbG9yOiBzdHJpbmc7XHJcbiAgICB9O1xyXG4gICAgY29udHJvbHNTY3JlZW5UZXh0OiB7XHJcbiAgICAgICAgdGl0bGU6IHN0cmluZztcclxuICAgICAgICBtb3ZlVGV4dDogc3RyaW5nO1xyXG4gICAgICAgIG9iamVjdGl2ZVRleHQ6IHN0cmluZztcclxuICAgICAgICB3YXJuaW5nVGV4dDogc3RyaW5nO1xyXG4gICAgICAgIGNvbnRpbnVlVGV4dDogc3RyaW5nO1xyXG4gICAgICAgIGNvbG9yOiBzdHJpbmc7XHJcbiAgICB9O1xyXG4gICAgZ2FtZU92ZXJTY3JlZW5UZXh0OiB7XHJcbiAgICAgICAgdGl0bGU6IHN0cmluZztcclxuICAgICAgICBzdWJ0aXRsZTogc3RyaW5nO1xyXG4gICAgICAgIHJlc3RhcnRUZXh0OiBzdHJpbmc7XHJcbiAgICAgICAgY29sb3I6IHN0cmluZztcclxuICAgIH07XHJcbiAgICBzY29yZURpc3BsYXlDb2xvcjogc3RyaW5nO1xyXG4gICAgYXNzZXRzOiB7XHJcbiAgICAgICAgaW1hZ2VzOiBBc3NldEltYWdlW107XHJcbiAgICAgICAgc291bmRzOiBBc3NldFNvdW5kW107XHJcbiAgICB9O1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQXNzZXRJbWFnZSB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBwYXRoOiBzdHJpbmc7XHJcbiAgICB3aWR0aDogbnVtYmVyO1xyXG4gICAgaGVpZ2h0OiBudW1iZXI7XHJcbn1cclxuXHJcbmludGVyZmFjZSBBc3NldFNvdW5kIHtcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIHBhdGg6IHN0cmluZztcclxuICAgIGR1cmF0aW9uX3NlY29uZHM6IG51bWJlcjtcclxuICAgIHZvbHVtZTogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgTG9hZGVkQXNzZXRzIHtcclxuICAgIGltYWdlczogeyBba2V5OiBzdHJpbmddOiBIVE1MSW1hZ2VFbGVtZW50IH07XHJcbiAgICBzb3VuZHM6IHsgW2tleTogc3RyaW5nXTogSFRNTEF1ZGlvRWxlbWVudCB9O1xyXG59XHJcblxyXG50eXBlIEdhbWVTdGF0ZSA9ICdUSVRMRScgfCAnQ09OVFJPTFMnIHwgJ1BMQVlJTkcnIHwgJ0dBTUVfT1ZFUic7XHJcbnR5cGUgRGlyZWN0aW9uID0gJ1VQJyB8ICdET1dOJyB8ICdMRUZUJyB8ICdSSUdIVCc7XHJcblxyXG5pbnRlcmZhY2UgU25ha2VTZWdtZW50IHtcclxuICAgIHg6IG51bWJlcjtcclxuICAgIHk6IG51bWJlcjtcclxufVxyXG5cclxubGV0IGNvbmZpZzogR2FtZUNvbmZpZztcclxubGV0IGxvYWRlZEFzc2V0czogTG9hZGVkQXNzZXRzO1xyXG5sZXQgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudDtcclxubGV0IGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG5cclxubGV0IGdhbWVTdGF0ZTogR2FtZVN0YXRlID0gJ1RJVExFJztcclxubGV0IHNuYWtlOiBTbmFrZVNlZ21lbnRbXTtcclxubGV0IGZvb2Q6IFNuYWtlU2VnbWVudDtcclxubGV0IHNjb3JlOiBudW1iZXI7XHJcbmxldCBjdXJyZW50RGlyZWN0aW9uOiBEaXJlY3Rpb247XHJcbmxldCBuZXh0RGlyZWN0aW9uOiBEaXJlY3Rpb247IC8vIEJ1ZmZlciBmb3IgaW1tZWRpYXRlIGRpcmVjdGlvbiBjaGFuZ2VcclxubGV0IGdhbWVJbnRlcnZhbElkOiBudW1iZXIgfCB1bmRlZmluZWQ7XHJcblxyXG5jb25zdCBLRVlfU1BBQ0UgPSAnICc7XHJcbmNvbnN0IEtFWV9FTlRFUiA9ICdFbnRlcic7XHJcbmNvbnN0IEtFWV9XID0gJ3cnO1xyXG5jb25zdCBLRVlfQSA9ICdhJztcclxuY29uc3QgS0VZX1MgPSAncyc7XHJcbmNvbnN0IEtFWV9EID0gJ2QnO1xyXG5jb25zdCBLRVlfVVAgPSAnQXJyb3dVcCc7XHJcbmNvbnN0IEtFWV9MRUZUID0gJ0Fycm93TGVmdCc7XHJcbmNvbnN0IEtFWV9ET1dOID0gJ0Fycm93RG93bic7XHJcbmNvbnN0IEtFWV9SSUdIVCA9ICdBcnJvd1JpZ2h0JztcclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGluaXRHYW1lKCkge1xyXG4gICAgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWVDYW52YXMnKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcclxuICAgIGlmICghY2FudmFzKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignQ2FudmFzIGVsZW1lbnQgd2l0aCBJRCBcImdhbWVDYW52YXNcIiBub3QgZm91bmQuJyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJykhO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnZGF0YS5qc29uJyk7XHJcbiAgICAgICAgY29uZmlnID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG5cclxuICAgICAgICBjYW52YXMud2lkdGggPSBjb25maWcuY2FudmFzV2lkdGg7XHJcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IGNvbmZpZy5jYW52YXNIZWlnaHQ7XHJcblxyXG4gICAgICAgIGxvYWRlZEFzc2V0cyA9IGF3YWl0IGxvYWRBc3NldHMoY29uZmlnLmFzc2V0cyk7XHJcbiAgICAgICAgc2V0dXBFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHJlc2V0R2FtZSgpOyAvLyBFbnN1cmUgaW5pdGlhbCBzdGF0ZSBpcyByZWFkeSBmb3IgdGl0bGUgc2NyZWVuXHJcbiAgICAgICAgZ2FtZUxvb3AoKTtcclxuXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGdhbWUgY29uZmlndXJhdGlvbiBvciBhc3NldHM6JywgZXJyb3IpO1xyXG4gICAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBsb2FkQXNzZXRzKGFzc2V0Q29uZmlnOiB7IGltYWdlczogQXNzZXRJbWFnZVtdOyBzb3VuZHM6IEFzc2V0U291bmRbXSB9KTogUHJvbWlzZTxMb2FkZWRBc3NldHM+IHtcclxuICAgIGNvbnN0IGltYWdlUHJvbWlzZXMgPSBhc3NldENvbmZpZy5pbWFnZXMubWFwKGltZyA9PiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPFtzdHJpbmcsIEhUTUxJbWFnZUVsZW1lbnRdPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGltYWdlID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgICAgIGltYWdlLnNyYyA9IGltZy5wYXRoO1xyXG4gICAgICAgICAgICBpbWFnZS5vbmxvYWQgPSAoKSA9PiByZXNvbHZlKFtpbWcubmFtZSwgaW1hZ2VdKTtcclxuICAgICAgICAgICAgaW1hZ2Uub25lcnJvciA9ICgpID0+IHJlamVjdChgRmFpbGVkIHRvIGxvYWQgaW1hZ2U6ICR7aW1nLnBhdGh9YCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBzb3VuZFByb21pc2VzID0gYXNzZXRDb25maWcuc291bmRzLm1hcChzbmQgPT4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxbc3RyaW5nLCBIVE1MQXVkaW9FbGVtZW50XT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhdWRpbyA9IG5ldyBBdWRpbygpO1xyXG4gICAgICAgICAgICBhdWRpby5zcmMgPSBzbmQucGF0aDtcclxuICAgICAgICAgICAgYXVkaW8udm9sdW1lID0gc25kLnZvbHVtZTtcclxuICAgICAgICAgICAgYXVkaW8ubG9vcCA9IHNuZC5uYW1lID09PSAnYmdtJzsgLy8gTG9vcCBiYWNrZ3JvdW5kIG11c2ljXHJcbiAgICAgICAgICAgIGF1ZGlvLm9uY2FucGxheXRocm91Z2ggPSAoKSA9PiByZXNvbHZlKFtzbmQubmFtZSwgYXVkaW9dKTtcclxuICAgICAgICAgICAgYXVkaW8ub25lcnJvciA9ICgpID0+IHJlamVjdChgRmFpbGVkIHRvIGxvYWQgc291bmQ6ICR7c25kLnBhdGh9YCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBsb2FkZWRJbWFnZXMgPSBhd2FpdCBQcm9taXNlLmFsbChpbWFnZVByb21pc2VzKTtcclxuICAgIGNvbnN0IGxvYWRlZFNvdW5kcyA9IGF3YWl0IFByb21pc2UuYWxsKHNvdW5kUHJvbWlzZXMpO1xyXG5cclxuICAgIGNvbnN0IGltYWdlc01hcDogeyBba2V5OiBzdHJpbmddOiBIVE1MSW1hZ2VFbGVtZW50IH0gPSB7fTtcclxuICAgIGxvYWRlZEltYWdlcy5mb3JFYWNoKChbbmFtZSwgaW1nXSkgPT4gKGltYWdlc01hcFtuYW1lXSA9IGltZykpO1xyXG5cclxuICAgIGNvbnN0IHNvdW5kc01hcDogeyBba2V5OiBzdHJpbmddOiBIVE1MQXVkaW9FbGVtZW50IH0gPSB7fTtcclxuICAgIGxvYWRlZFNvdW5kcy5mb3JFYWNoKChbbmFtZSwgYXVkaW9dKSA9PiAoc291bmRzTWFwW25hbWVdID0gYXVkaW8pKTtcclxuXHJcbiAgICByZXR1cm4geyBpbWFnZXM6IGltYWdlc01hcCwgc291bmRzOiBzb3VuZHNNYXAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0dXBFdmVudExpc3RlbmVycygpIHtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVLZXlEb3duKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlS2V5RG93bihldmVudDogS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgY29uc3Qga2V5ID0gZXZlbnQua2V5O1xyXG5cclxuICAgIGlmIChnYW1lU3RhdGUgPT09ICdUSVRMRScgfHwgZ2FtZVN0YXRlID09PSAnQ09OVFJPTFMnIHx8IGdhbWVTdGF0ZSA9PT0gJ0dBTUVfT1ZFUicpIHtcclxuICAgICAgICBpZiAoa2V5ID09PSBLRVlfU1BBQ0UgfHwga2V5ID09PSBLRVlfRU5URVIpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgLy8gUHJldmVudCBzY3JvbGxpbmdcclxuICAgICAgICAgICAgaWYgKGdhbWVTdGF0ZSA9PT0gJ1RJVExFJykge1xyXG4gICAgICAgICAgICAgICAgZ2FtZVN0YXRlID0gJ0NPTlRST0xTJztcclxuICAgICAgICAgICAgICAgIHBsYXlCR00oKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChnYW1lU3RhdGUgPT09ICdDT05UUk9MUycpIHtcclxuICAgICAgICAgICAgICAgIGdhbWVTdGF0ZSA9ICdQTEFZSU5HJztcclxuICAgICAgICAgICAgICAgIHN0YXJ0R2FtZUludGVydmFsKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ2FtZVN0YXRlID09PSAnR0FNRV9PVkVSJykge1xyXG4gICAgICAgICAgICAgICAgcmVzZXRHYW1lKCk7XHJcbiAgICAgICAgICAgICAgICBnYW1lU3RhdGUgPSAnVElUTEUnO1xyXG4gICAgICAgICAgICAgICAgc3RvcEJHTSgpOyBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoZ2FtZVN0YXRlID09PSAnUExBWUlORycpIHtcclxuICAgICAgICBsZXQgbmV3RGlyZWN0aW9uOiBEaXJlY3Rpb24gfCBudWxsID0gbnVsbDtcclxuICAgICAgICBzd2l0Y2ggKGtleSkge1xyXG4gICAgICAgICAgICBjYXNlIEtFWV9VUDpcclxuICAgICAgICAgICAgY2FzZSBLRVlfVzpcclxuICAgICAgICAgICAgICAgIG5ld0RpcmVjdGlvbiA9ICdVUCc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBLRVlfRE9XTjpcclxuICAgICAgICAgICAgY2FzZSBLRVlfUzpcclxuICAgICAgICAgICAgICAgIG5ld0RpcmVjdGlvbiA9ICdET1dOJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIEtFWV9MRUZUOlxyXG4gICAgICAgICAgICBjYXNlIEtFWV9BOlxyXG4gICAgICAgICAgICAgICAgbmV3RGlyZWN0aW9uID0gJ0xFRlQnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgS0VZX1JJR0hUOlxyXG4gICAgICAgICAgICBjYXNlIEtFWV9EOlxyXG4gICAgICAgICAgICAgICAgbmV3RGlyZWN0aW9uID0gJ1JJR0hUJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG5ld0RpcmVjdGlvbikge1xyXG4gICAgICAgICAgICAvLyBQcmV2ZW50IGltbWVkaWF0ZSByZXZlcnNlIGRpcmVjdGlvblxyXG4gICAgICAgICAgICBpZiAoISgobmV3RGlyZWN0aW9uID09PSAnVVAnICYmIGN1cnJlbnREaXJlY3Rpb24gPT09ICdET1dOJykgfHxcclxuICAgICAgICAgICAgICAgIChuZXdEaXJlY3Rpb24gPT09ICdET1dOJyAmJiBjdXJyZW50RGlyZWN0aW9uID09PSAnVVAnKSB8fFxyXG4gICAgICAgICAgICAgICAgKG5ld0RpcmVjdGlvbiA9PT0gJ0xFRlQnICYmIGN1cnJlbnREaXJlY3Rpb24gPT09ICdSSUdIVCcpIHx8XHJcbiAgICAgICAgICAgICAgICAobmV3RGlyZWN0aW9uID09PSAnUklHSFQnICYmIGN1cnJlbnREaXJlY3Rpb24gPT09ICdMRUZUJykpKSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0RGlyZWN0aW9uID0gbmV3RGlyZWN0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vIFByZXZlbnQgZGVmYXVsdCBicm93c2VyIGFjdGlvbnMgZm9yIGFycm93IGtleXNcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlc2V0R2FtZSgpIHtcclxuICAgIHNuYWtlID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbmZpZy5pbml0aWFsU25ha2VMZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHNuYWtlLnB1c2goeyB4OiBNYXRoLmZsb29yKGNvbmZpZy5jYW52YXNXaWR0aCAvIDIgLyBjb25maWcuZ3JpZFNpemUpLCB5OiBNYXRoLmZsb29yKGNvbmZpZy5jYW52YXNIZWlnaHQgLyAyIC8gY29uZmlnLmdyaWRTaXplKSArIGkgfSk7XHJcbiAgICB9XHJcbiAgICBjdXJyZW50RGlyZWN0aW9uID0gJ1VQJztcclxuICAgIG5leHREaXJlY3Rpb24gPSAnVVAnO1xyXG4gICAgc2NvcmUgPSAwO1xyXG4gICAgZ2VuZXJhdGVGb29kKCk7XHJcbiAgICBzdG9wR2FtZUludGVydmFsKCk7XHJcbiAgICBpZiAoZ2FtZVN0YXRlID09PSAnR0FNRV9PVkVSJykge1xyXG4gICAgICAgIHN0b3BCR00oKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc3RhcnRHYW1lSW50ZXJ2YWwoKSB7XHJcbiAgICBpZiAoZ2FtZUludGVydmFsSWQpIHtcclxuICAgICAgICBjbGVhckludGVydmFsKGdhbWVJbnRlcnZhbElkKTtcclxuICAgIH1cclxuICAgIGdhbWVJbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoZ2FtZVRpY2ssIGNvbmZpZy5nYW1lU3BlZWRNcyk7XHJcbiAgICBwbGF5QkdNKCk7IFxyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wR2FtZUludGVydmFsKCkge1xyXG4gICAgaWYgKGdhbWVJbnRlcnZhbElkKSB7XHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbChnYW1lSW50ZXJ2YWxJZCk7XHJcbiAgICAgICAgZ2FtZUludGVydmFsSWQgPSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdhbWVUaWNrKCkge1xyXG4gICAgaWYgKGdhbWVTdGF0ZSAhPT0gJ1BMQVlJTkcnKSByZXR1cm47XHJcblxyXG4gICAgY3VycmVudERpcmVjdGlvbiA9IG5leHREaXJlY3Rpb247XHJcblxyXG4gICAgY29uc3QgaGVhZCA9IHsgLi4uc25ha2VbMF0gfTtcclxuXHJcbiAgICBzd2l0Y2ggKGN1cnJlbnREaXJlY3Rpb24pIHtcclxuICAgICAgICBjYXNlICdVUCc6XHJcbiAgICAgICAgICAgIGhlYWQueS0tO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdET1dOJzpcclxuICAgICAgICAgICAgaGVhZC55Kys7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ0xFRlQnOlxyXG4gICAgICAgICAgICBoZWFkLngtLTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnUklHSFQnOlxyXG4gICAgICAgICAgICBoZWFkLngrKztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKFxyXG4gICAgICAgIGhlYWQueCA8IDAgfHxcclxuICAgICAgICBoZWFkLnggPj0gY29uZmlnLmNhbnZhc1dpZHRoIC8gY29uZmlnLmdyaWRTaXplIHx8XHJcbiAgICAgICAgaGVhZC55IDwgMCB8fFxyXG4gICAgICAgIGhlYWQueSA+PSBjb25maWcuY2FudmFzSGVpZ2h0IC8gY29uZmlnLmdyaWRTaXplIHx8XHJcbiAgICAgICAgY2hlY2tTZWxmQ29sbGlzaW9uKGhlYWQpXHJcbiAgICApIHtcclxuICAgICAgICBlbmRHYW1lKCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHNuYWtlLnVuc2hpZnQoaGVhZCk7XHJcblxyXG4gICAgaWYgKGhlYWQueCA9PT0gZm9vZC54ICYmIGhlYWQueSA9PT0gZm9vZC55KSB7XHJcbiAgICAgICAgc2NvcmUgKz0gY29uZmlnLnNjb3JlUGVyRm9vZDtcclxuICAgICAgICBsb2FkZWRBc3NldHMuc291bmRzWydlYXRfZm9vZCddPy5wbGF5KCk7XHJcbiAgICAgICAgZ2VuZXJhdGVGb29kKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNuYWtlLnBvcCgpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja1NlbGZDb2xsaXNpb24oaGVhZDogU25ha2VTZWdtZW50KTogYm9vbGVhbiB7XHJcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IHNuYWtlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKGhlYWQueCA9PT0gc25ha2VbaV0ueCAmJiBoZWFkLnkgPT09IHNuYWtlW2ldLnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZW5lcmF0ZUZvb2QoKSB7XHJcbiAgICBsZXQgbmV3Rm9vZDogU25ha2VTZWdtZW50O1xyXG4gICAgY29uc3QgbWF4WCA9IGNvbmZpZy5jYW52YXNXaWR0aCAvIGNvbmZpZy5ncmlkU2l6ZTtcclxuICAgIGNvbnN0IG1heFkgPSBjb25maWcuY2FudmFzSGVpZ2h0IC8gY29uZmlnLmdyaWRTaXplO1xyXG4gICAgZG8ge1xyXG4gICAgICAgIG5ld0Zvb2QgPSB7XHJcbiAgICAgICAgICAgIHg6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG1heFgpLFxyXG4gICAgICAgICAgICB5OiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBtYXhZKVxyXG4gICAgICAgIH07XHJcbiAgICB9IHdoaWxlIChpc09jY3VwaWVkQnlTbmFrZShuZXdGb29kKSk7XHJcbiAgICBmb29kID0gbmV3Rm9vZDtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNPY2N1cGllZEJ5U25ha2Uoc2VnbWVudDogU25ha2VTZWdtZW50KTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gc25ha2Uuc29tZShzID0+IHMueCA9PT0gc2VnbWVudC54ICYmIHMueSA9PT0gc2VnbWVudC55KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZW5kR2FtZSgpIHtcclxuICAgIGdhbWVTdGF0ZSA9ICdHQU1FX09WRVInO1xyXG4gICAgc3RvcEdhbWVJbnRlcnZhbCgpO1xyXG4gICAgbG9hZGVkQXNzZXRzLnNvdW5kc1snZ2FtZV9vdmVyJ10/LnBsYXkoKTtcclxuICAgIHN0b3BCR00oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcGxheUJHTSgpIHtcclxuICAgIGNvbnN0IGJnbSA9IGxvYWRlZEFzc2V0cy5zb3VuZHNbJ2JnbSddO1xyXG4gICAgaWYgKGJnbSAmJiBiZ20ucGF1c2VkKSB7XHJcbiAgICAgICAgYmdtLmN1cnJlbnRUaW1lID0gMDtcclxuICAgICAgICBiZ20ucGxheSgpLmNhdGNoKGUgPT4gY29uc29sZS53YXJuKFwiQkdNIGF1dG9wbGF5IHByZXZlbnRlZDpcIiwgZSkpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wQkdNKCkge1xyXG4gICAgY29uc3QgYmdtID0gbG9hZGVkQXNzZXRzLnNvdW5kc1snYmdtJ107XHJcbiAgICBpZiAoYmdtICYmICFiZ20ucGF1c2VkKSB7XHJcbiAgICAgICAgYmdtLnBhdXNlKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdhbWVMb29wKCkge1xyXG4gICAgZHJhdygpO1xyXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGdhbWVMb29wKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZHJhdygpIHtcclxuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY29uZmlnLmNhbnZhc1dpZHRoLCBjb25maWcuY2FudmFzSGVpZ2h0KTtcclxuXHJcbiAgICBjb25zdCBiZ0ltYWdlID0gbG9hZGVkQXNzZXRzLmltYWdlc1snYmFja2dyb3VuZCddO1xyXG4gICAgaWYgKGJnSW1hZ2UpIHtcclxuICAgICAgICBjdHguZHJhd0ltYWdlKGJnSW1hZ2UsIDAsIDAsIGNvbmZpZy5jYW52YXNXaWR0aCwgY29uZmlnLmNhbnZhc0hlaWdodCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSAnIzFhMWEyZSc7XHJcbiAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIGNvbmZpZy5jYW52YXNXaWR0aCwgY29uZmlnLmNhbnZhc0hlaWdodCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGdhbWVTdGF0ZSA9PT0gJ1RJVExFJykge1xyXG4gICAgICAgIGRyYXdUaXRsZVNjcmVlbigpO1xyXG4gICAgfSBlbHNlIGlmIChnYW1lU3RhdGUgPT09ICdDT05UUk9MUycpIHtcclxuICAgICAgICBkcmF3Q29udHJvbHNTY3JlZW4oKTtcclxuICAgIH0gZWxzZSBpZiAoZ2FtZVN0YXRlID09PSAnUExBWUlORycpIHtcclxuICAgICAgICBkcmF3UGxheWluZ1N0YXRlKCk7XHJcbiAgICB9IGVsc2UgaWYgKGdhbWVTdGF0ZSA9PT0gJ0dBTUVfT1ZFUicpIHtcclxuICAgICAgICBkcmF3R2FtZU92ZXJTY3JlZW4oKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd1RpdGxlU2NyZWVuKCkge1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IGNvbmZpZy50aXRsZVNjcmVlblRleHQuY29sb3I7XHJcbiAgICBjdHguZm9udCA9IGNvbmZpZy51aUZvbnQ7XHJcbiAgICBjdHgudGV4dEFsaWduID0gJ2NlbnRlcic7XHJcbiAgICBjdHgudGV4dEJhc2VsaW5lID0gJ21pZGRsZSc7XHJcblxyXG4gICAgY3R4LmZpbGxUZXh0KGNvbmZpZy50aXRsZVNjcmVlblRleHQudGl0bGUsIGNvbmZpZy5jYW52YXNXaWR0aCAvIDIsIGNvbmZpZy5jYW52YXNIZWlnaHQgLyAyIC0gNTApO1xyXG4gICAgY3R4LmZvbnQgPSBjb25maWcuc21hbGxVaUZvbnQ7XHJcbiAgICBjdHguZmlsbFRleHQoY29uZmlnLnRpdGxlU2NyZWVuVGV4dC5zdWJ0aXRsZSwgY29uZmlnLmNhbnZhc1dpZHRoIC8gMiwgY29uZmlnLmNhbnZhc0hlaWdodCAvIDIgKyAyMCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdDb250cm9sc1NjcmVlbigpIHtcclxuICAgIGN0eC5maWxsU3R5bGUgPSBjb25maWcuY29udHJvbHNTY3JlZW5UZXh0LmNvbG9yO1xyXG4gICAgY3R4LmZvbnQgPSBjb25maWcudWlGb250O1xyXG4gICAgY3R4LnRleHRBbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgY3R4LnRleHRCYXNlbGluZSA9ICdtaWRkbGUnO1xyXG5cclxuICAgIGN0eC5maWxsVGV4dChjb25maWcuY29udHJvbHNTY3JlZW5UZXh0LnRpdGxlLCBjb25maWcuY2FudmFzV2lkdGggLyAyLCBjb25maWcuY2FudmFzSGVpZ2h0IC8gMiAtIDEyMCk7XHJcblxyXG4gICAgY3R4LmZvbnQgPSBjb25maWcuc21hbGxVaUZvbnQ7XHJcbiAgICBjdHguZmlsbFRleHQoY29uZmlnLmNvbnRyb2xzU2NyZWVuVGV4dC5tb3ZlVGV4dCwgY29uZmlnLmNhbnZhc1dpZHRoIC8gMiwgY29uZmlnLmNhbnZhc0hlaWdodCAvIDIgLSA0MCk7XHJcbiAgICBjdHguZmlsbFRleHQoY29uZmlnLmNvbnRyb2xzU2NyZWVuVGV4dC5vYmplY3RpdmVUZXh0LCBjb25maWcuY2FudmFzV2lkdGggLyAyLCBjb25maWcuY2FudmFzSGVpZ2h0IC8gMik7XHJcbiAgICBjdHguZmlsbFRleHQoY29uZmlnLmNvbnRyb2xzU2NyZWVuVGV4dC53YXJuaW5nVGV4dCwgY29uZmlnLmNhbnZhc1dpZHRoIC8gMiwgY29uZmlnLmNhbnZhc0hlaWdodCAvIDIgKyA0MCk7XHJcblxyXG4gICAgY3R4LmZpbGxUZXh0KGNvbmZpZy5jb250cm9sc1NjcmVlblRleHQuY29udGludWVUZXh0LCBjb25maWcuY2FudmFzV2lkdGggLyAyLCBjb25maWcuY2FudmFzSGVpZ2h0IC8gMiArIDEyMCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdQbGF5aW5nU3RhdGUoKSB7XHJcbiAgICBjb25zdCBmb29kSW1hZ2UgPSBsb2FkZWRBc3NldHMuaW1hZ2VzWydmb29kJ107XHJcbiAgICBpZiAoZm9vZEltYWdlKSB7XHJcbiAgICAgICAgY3R4LmRyYXdJbWFnZShmb29kSW1hZ2UsIGZvb2QueCAqIGNvbmZpZy5ncmlkU2l6ZSwgZm9vZC55ICogY29uZmlnLmdyaWRTaXplLCBjb25maWcuZ3JpZFNpemUsIGNvbmZpZy5ncmlkU2l6ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSAnb3JhbmdlJzsgLy8gRmFsbGJhY2tcclxuICAgICAgICBjdHguZmlsbFJlY3QoZm9vZC54ICogY29uZmlnLmdyaWRTaXplLCBmb29kLnkgKiBjb25maWcuZ3JpZFNpemUsIGNvbmZpZy5ncmlkU2l6ZSwgY29uZmlnLmdyaWRTaXplKTtcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNuYWtlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3Qgc2VnbWVudCA9IHNuYWtlW2ldO1xyXG4gICAgICAgIGNvbnN0IGFzc2V0TmFtZSA9IChpID09PSAwKSA/ICdzbmFrZV9oZWFkJyA6ICdzbmFrZV9ib2R5JztcclxuICAgICAgICBjb25zdCBpbWFnZSA9IGxvYWRlZEFzc2V0cy5pbWFnZXNbYXNzZXROYW1lXTtcclxuXHJcbiAgICAgICAgaWYgKGltYWdlKSB7XHJcbiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1hZ2UsIHNlZ21lbnQueCAqIGNvbmZpZy5ncmlkU2l6ZSwgc2VnbWVudC55ICogY29uZmlnLmdyaWRTaXplLCBjb25maWcuZ3JpZFNpemUsIGNvbmZpZy5ncmlkU2l6ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IChpID09PSAwKSA/ICcjMDBGRjAwJyA6ICcjMDBBQTAwJzsgLy8gRmFsbGJhY2sgY29sb3JzIGZvciBoZWFkL2JvZHlcclxuICAgICAgICAgICAgY3R4LmZpbGxSZWN0KHNlZ21lbnQueCAqIGNvbmZpZy5ncmlkU2l6ZSwgc2VnbWVudC55ICogY29uZmlnLmdyaWRTaXplLCBjb25maWcuZ3JpZFNpemUsIGNvbmZpZy5ncmlkU2l6ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGN0eC5maWxsU3R5bGUgPSBjb25maWcuc2NvcmVEaXNwbGF5Q29sb3I7XHJcbiAgICBjdHguZm9udCA9IGNvbmZpZy5zbWFsbFVpRm9udDtcclxuICAgIGN0eC50ZXh0QWxpZ24gPSAnbGVmdCc7XHJcbiAgICBjdHgudGV4dEJhc2VsaW5lID0gJ3RvcCc7XHJcbiAgICBjdHguZmlsbFRleHQoYFx1QzgxMFx1QzIxODogJHtzY29yZX1gLCAxMCwgMTApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkcmF3R2FtZU92ZXJTY3JlZW4oKSB7XHJcbiAgICBjdHguZmlsbFN0eWxlID0gY29uZmlnLmdhbWVPdmVyU2NyZWVuVGV4dC5jb2xvcjtcclxuICAgIGN0eC5mb250ID0gY29uZmlnLnVpRm9udDtcclxuICAgIGN0eC50ZXh0QWxpZ24gPSAnY2VudGVyJztcclxuICAgIGN0eC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJztcclxuXHJcbiAgICBjdHguZmlsbFRleHQoY29uZmlnLmdhbWVPdmVyU2NyZWVuVGV4dC50aXRsZSwgY29uZmlnLmNhbnZhc1dpZHRoIC8gMiwgY29uZmlnLmNhbnZhc0hlaWdodCAvIDIgLSA1MCk7XHJcbiAgICBjdHguZm9udCA9IGNvbmZpZy5zbWFsbFVpRm9udDtcclxuICAgIGN0eC5maWxsVGV4dChgJHtjb25maWcuZ2FtZU92ZXJTY3JlZW5UZXh0LnN1YnRpdGxlfSAke3Njb3JlfWAsIGNvbmZpZy5jYW52YXNXaWR0aCAvIDIsIGNvbmZpZy5jYW52YXNIZWlnaHQgLyAyKTtcclxuICAgIGN0eC5maWxsVGV4dChjb25maWcuZ2FtZU92ZXJTY3JlZW5UZXh0LnJlc3RhcnRUZXh0LCBjb25maWcuY2FudmFzV2lkdGggLyAyLCBjb25maWcuY2FudmFzSGVpZ2h0IC8gMiArIDUwKTtcclxufVxyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRHYW1lKTtcclxuIl0sCiAgIm1hcHBpbmdzIjogIkFBOERBLElBQUk7QUFDSixJQUFJO0FBQ0osSUFBSTtBQUNKLElBQUk7QUFFSixJQUFJLFlBQXVCO0FBQzNCLElBQUk7QUFDSixJQUFJO0FBQ0osSUFBSTtBQUNKLElBQUk7QUFDSixJQUFJO0FBQ0osSUFBSTtBQUVKLE1BQU0sWUFBWTtBQUNsQixNQUFNLFlBQVk7QUFDbEIsTUFBTSxRQUFRO0FBQ2QsTUFBTSxRQUFRO0FBQ2QsTUFBTSxRQUFRO0FBQ2QsTUFBTSxRQUFRO0FBQ2QsTUFBTSxTQUFTO0FBQ2YsTUFBTSxXQUFXO0FBQ2pCLE1BQU0sV0FBVztBQUNqQixNQUFNLFlBQVk7QUFFbEIsZUFBZSxXQUFXO0FBQ3RCLFdBQVMsU0FBUyxlQUFlLFlBQVk7QUFDN0MsTUFBSSxDQUFDLFFBQVE7QUFDVCxZQUFRLE1BQU0sZ0RBQWdEO0FBQzlEO0FBQUEsRUFDSjtBQUNBLFFBQU0sT0FBTyxXQUFXLElBQUk7QUFFNUIsTUFBSTtBQUNBLFVBQU0sV0FBVyxNQUFNLE1BQU0sV0FBVztBQUN4QyxhQUFTLE1BQU0sU0FBUyxLQUFLO0FBRTdCLFdBQU8sUUFBUSxPQUFPO0FBQ3RCLFdBQU8sU0FBUyxPQUFPO0FBRXZCLG1CQUFlLE1BQU0sV0FBVyxPQUFPLE1BQU07QUFDN0Msd0JB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
